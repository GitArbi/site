!function(){var e={},o=null,t=["checkout","addtocart","removefromcart","viewproduct","pageview"],n=[],r=[],c={},i={},a={pixelId:"a",transactionId:"b",userId:"c",cartValue:"d",taxValue:"e",shippingValue:"f",shippingCity:"g",shippingState:"h",shippingCountry:"i",currency:"j",numProducts:"k",productId:"l",productName:"m",quantity:"n",price:"o",displayPrice:"p",sku:"q",category:"r",eventType:"s",firstPartyCuid:"t",referrer:"u",title:"v",location:"w",path:"x"},d="crl8.fpcuid",u=!1,s=function(e){return e.replace?e.replace(/\|/g,""):e},l=function(e){var o=function(e){for(var o=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(o))return r.substring(o.length,r.length)}return""},t=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=16*Math.random()|0,t="x"===e?o:3&o|8;return t.toString(16)})},n=o(e),r=n?n:t(),c=new Date;c.setTime(c.getTime()+31536e6);var i,a=c.toGMTString(),d=document.domain.split(".");return i=-1!==["co","com"].indexOf(d[d.length-2])?"."+d.slice(-3).join("."):"."+d.slice(-2).join("."),document.cookie=e+"="+r+";expires="+a+";domain="+i+";path=/",r},p=l(d),f=document.referrer,h=function(e,o){return e.hasOwnProperty("productId")&&e.hasOwnProperty("productName")?-1===t.indexOf(o.toLowerCase())?void console.error("crl8: Invalid event type. Event type must be one of "+t.join(", ")):(e.eventType=o.toLowerCase(),void("checkout"===e.eventType?r.push(e):n.push(e))):void console.error("crl8: Product info is missing. Product id and product name must be included for product:",e)},v=function(){return r.length>0},g=function(e){var o,t=[];if(e){for(Object.keys(c).forEach(function(e){t.push(a[e]+"="+encodeURIComponent(c[e]))}),t.push(a.numProducts+"="+(r.length+n.length)),o=0;o<r.length;o++)Object.keys(r[o]).forEach(function(e){t.push(a[e]+o+"="+encodeURIComponent(r[o][e]))});y("Preparing to send "+r.length+" product(s) as part of checkout.",r)}else t.push(a.numProducts+"="+n.length);var d=e?r.length:0;for(o=0;o<n.length;o++)Object.keys(n[o]).forEach(function(e){t.push(a[e]+(o+d)+"="+encodeURIComponent(n[o][e]))});return n.length>0&&y("Preparing to send "+n.length+" product(s).",n),Object.keys(i).forEach(function(e){t.push(a[e]+"="+encodeURIComponent(s(i[e])))}),t.push(a.firstPartyCuid+"="+p),t.push(a.referrer+"="+encodeURIComponent(s(f))),t.join("&")},m=function(e){var t=document.createElement("img"),n="https:"===document.location.protocol?"https:":"http:",r=g(e);t.src=n+"//e.curalate.com/api/v1/pixel/"+o+"/pixel.png?"+r,t.onload=function(){y("Curalate pixel ID "+o+" fired successfully.")},t.onerror=function(){y("Curalate pixel "+o+" failed to fire.")},document.body.appendChild(t)},x=function(e){e&&(r=[],c={}),n=[],i={}},w=function(){for(;window.crl8.q.length>0;){var o=window.crl8.q.shift(),t=o[0],n=Array.prototype.slice.call(o).slice(1);"function"==typeof e[t]?e[t].call(window,n):console.error("crl8: Invalid function specified: "+t)}},y=function(e,o){var t=!!document.documentMode;u&&(o&&t?console.log("[crl8 debug] "+e,JSON.stringify(o)):o?console.log("[crl8 debug] "+e,o):console.log("[crl8 debug] "+e))};e.init=function(e){o=e[0],u=e[1]?e[1]:!1,y("Debug mode enabled.")},e.pageView=function(e){var o=e[0]?e[0]:{location:window.location.href};return Object.keys(i).length>0?void console.error("crl8: Only 1 pageview can be recorded at a time. Call send before adding a second pageview."):o.hasOwnProperty("location")||o.hasOwnProperty("path")?(i=o,void y("Viewed page:",o)):void console.error("crl8: must define either a location or path for Pageview events. Please add one of location or path.")},e.addToCart=function(e){var o=e[0];h(o,"addtocart"),y("Added product to cart:",o)},e.removeFromCart=function(e){var o=e[0];h(o,"removefromcart"),y("Removed product from cart:",o)},e.viewProduct=function(e){var o=e[0];h(o,"viewproduct"),y("Viewed product:",o)},e.addProduct=function(e){var o=e[0];h(o,"checkout"),y("Added product for checkout:",o)},e.addTransactionInfo=function(e){var o=e[0];return Object.keys(c).length>0?void console.error("crl8: Only 1 transaction can be added at a time. Call send before adding a second transaction."):o.hasOwnProperty("transactionId")?(c=o,void y("Added transaction info for checkout:",o)):void console.error("crl8: Transaction id must be included in info for transaction:",o)},e.send=function(i){if(!o)return void console.error("crl8: Curalate pixel must be initialized with a pixel id before data can be sent.");if(i.length>0){var a=i[0].toLowerCase(),d=i[1];t.indexOf(a.toLowerCase())>=0?("addtocart"===a?e.addToCart([d]):"viewproduct"===a?e.viewProduct([d]):"removefromcart"===a?e.removeFromCart([d]):"pageview"===a&&e.pageView([d]),m(!1),x(!1)):console.error("crl8: Unsupported event type passed in to 'send'.")}else{if(0===r.length&&0===n.length)return void console.error("crl8: 0 products have been added. At least 1 product must be added to send data.");if(Object.keys(c).length>0){if(!c.hasOwnProperty("transactionId"))return void console.error("crl8: Transaction id must be specified before checkout data can be sent.");if(!v())return void console.error("crl8: 0 checkout products have been added. At least 1 product must be added to send checkout data.")}else if(v()&&0===Object.keys(c).length)return void console.error("crl8: Transaction info must be added with addTransactionInfo before checkout data can be sent.");m(!0),x(!0)}},w(),window.crl8=function(){window.crl8.q=[],window.crl8.q.push(arguments),w()}}();
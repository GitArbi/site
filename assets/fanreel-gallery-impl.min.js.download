var Curalate = window.Curalate || {};
try {
	(function(Curalate) {
		var define = undefined;
		var module = undefined;
		var exports = undefined;
		var Curalate=window.Curalate||{};!function(t,e){Curalate.Spinner=e()}(this,function(){"use strict";function t(t,e){var i,o=document.createElement(t||"div");for(i in e)o[i]=e[i];return o}function e(t){for(var e=1,i=arguments.length;i>e;e++)t.appendChild(arguments[e]);return t}function i(t,e,i,o){var r=["opacity",e,~~(100*t),i,o].join("-"),n=.01+i/o*100,s=Math.max(1-(1-t)/e*(100-n),t),a=f.substring(0,f.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return c[r]||(d.insertRule("@"+l+"keyframes "+r+"{0%{opacity:"+s+"}"+n+"%{opacity:"+t+"}"+(n+.01)+"%{opacity:1}"+(n+e)%100+"%{opacity:"+t+"}100%{opacity:"+s+"}}",d.cssRules.length),c[r]=1),r}function o(t,e){var i,o,r=t.style;if(void 0!==r[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<u.length;o++)if(i=u[o]+e,void 0!==r[i])return i}function r(t,e){for(var i in e)t.style[o(t,i)||i]=e[i];return t}function n(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)void 0===t[o]&&(t[o]=i[o])}return t}function s(t){for(var e={x:t.offsetLeft,y:t.offsetTop};t=t.offsetParent;)e.x+=t.offsetLeft,e.y+=t.offsetTop;return e}function a(t){return"undefined"==typeof this?new a(t):void(this.opts=n(t||{},a.defaults,p))}function l(){function i(e,i){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}d.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(t,o){function n(){return r(i("group",{coordsize:f+" "+f,coordorigin:-l+" "+-l}),{width:f,height:f})}function s(t,s,a){e(c,e(r(n(),{rotation:360/o.lines*t+"deg",left:~~s}),e(r(i("roundrect",{arcsize:o.corners}),{width:l,height:o.width,left:o.radius,top:-o.width>>1,filter:a}),i("fill",{color:o.color,opacity:o.opacity}),i("stroke",{opacity:0}))))}var a,l=o.length+o.width,f=2*l,u=2*-(o.width+o.length)+"px",c=r(n(),{position:"absolute",top:u,left:u});if(o.shadow)for(a=1;a<=o.lines;a++)s(a,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(a=1;a<=o.lines;a++)s(a);return e(t,c)},a.prototype.opacity=function(t,e,i,o){var r=t.firstChild;o=o.shadow&&o.lines||0,r&&e+o<r.childNodes.length&&(r=r.childNodes[e+o],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=i))}}var f,u=["webkit","Moz","ms","O"],c={},d=function(){var i=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};a.defaults={},n(a.prototype,{spin:function(e){this.stop();var i,o,n=this,a=n.opts,l=n.el=r(t(0,{className:a.className}),{position:a.position,width:0,zIndex:a.zIndex}),u=a.radius+a.length+a.width;if(e&&(e.insertBefore(l,e.firstChild||null),o=s(e),i=s(l),r(l,{left:("auto"==a.left?o.x-i.x+(e.offsetWidth>>1):parseInt(a.left,10)+u)+"px",top:("auto"==a.top?o.y-i.y+(e.offsetHeight>>1):parseInt(a.top,10)+u)+"px"})),l.setAttribute("role","progressbar"),n.lines(l,n.opts),!f){var c,d=0,p=(a.lines-1)*(1-a.direction)/2,h=a.fps,m=h/a.speed,y=(1-a.opacity)/(m*a.trail/100),g=m/a.lines;!function v(){d++;for(var t=0;t<a.lines;t++)c=Math.max(1-(d+(a.lines-t)*g)%m*y,a.opacity),n.opacity(l,t*a.direction+p,c,a);n.timeout=n.el&&setTimeout(v,~~(1e3/h))}()}return n},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(o,n){function s(e,i){return r(t(),{position:"absolute",width:n.length+n.width+"px",height:n.width+"px",background:e,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/n.lines*l+n.rotate)+"deg) translate("+n.radius+"px,0)",borderRadius:(n.corners*n.width>>1)+"px"})}for(var a,l=0,u=(n.lines-1)*(1-n.direction)/2;l<n.lines;l++)a=r(t(),{position:"absolute",top:1+~(n.width/2)+"px",transform:n.hwaccel?"translate3d(0,0,0)":"",opacity:n.opacity,animation:f&&i(n.opacity,n.trail,u+l*n.direction,n.lines)+" "+1/n.speed+"s linear infinite"}),n.shadow&&e(a,r(s("#000","0 0 4px #000"),{top:"2px"})),e(o,e(a,s(n.color,"0 0 1px rgba(0,0,0,.1)")));return o},opacity:function(t,e,i){e<t.childNodes.length&&(t.childNodes[e].style.opacity=i)}});var h=r(t("group"),{behavior:"url(#default#VML)"});return!o(h,"transform")&&h.adj?l():f=o(h,"animation"),a});
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,j=i.bind,w=function(n){return n instanceof w?n:this instanceof w?void(this._wrapped=n):new w(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):n._=w,w.VERSION="1.4.4";var A=w.each=w.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(w.has(n,a)&&t.call(e,n[a],a,n)===r)return};w.map=w.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)};var O="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=w.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},w.reduceRight=w.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=w.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=w.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},w.find=w.detect=function(n,t,r){var e;return E(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},w.filter=w.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},w.reject=function(n,t,r){return w.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},w.every=w.all=function(n,t,e){t||(t=w.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var E=w.some=w.any=function(n,t,e){t||(t=w.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};w.contains=w.include=function(n,t){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(t):E(n,function(n){return n===t})},w.invoke=function(n,t){var r=o.call(arguments,2),e=w.isFunction(t);return w.map(n,function(n){return(e?t:n[t]).apply(n,r)})},w.pluck=function(n,t){return w.map(n,function(n){return n[t]})},w.where=function(n,t,r){return w.isEmpty(t)?r?null:[]:w[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},w.findWhere=function(n,t){return w.where(n,t,!0)},w.max=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&w.isEmpty(n))return-(1/0);var e={computed:-(1/0),value:-(1/0)};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},w.min=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&w.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},w.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=w.random(r++),e[r-1]=e[t],e[t]=n}),e};var k=function(n){return w.isFunction(n)?n:function(t){return t[n]}};w.sortBy=function(n,t,r){var e=k(t);return w.pluck(w.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index<t.index?-1:1}),"value")};var F=function(n,t,r,e){var u={},i=k(t||w.identity);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};w.groupBy=function(n,t,r){return F(n,t,r,function(n,t,r){(w.has(n,t)?n[t]:n[t]=[]).push(r)})},w.countBy=function(n,t,r){return F(n,t,r,function(n,t){w.has(n,t)||(n[t]=0),n[t]++})},w.sortedIndex=function(n,t,r,e){r=null==r?w.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},w.toArray=function(n){return n?w.isArray(n)?o.call(n):n.length===+n.length?w.map(n,w.identity):w.values(n):[]},w.size=function(n){return null==n?0:n.length===+n.length?n.length:w.keys(n).length},w.first=w.head=w.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},w.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},w.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},w.rest=w.tail=w.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},w.compact=function(n){return w.filter(n,w.identity)};var R=function(n,t,r){return A(n,function(n){w.isArray(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r};w.flatten=function(n,t){return R(n,t,[])},w.without=function(n){return w.difference(n,o.call(arguments,1))},w.uniq=w.unique=function(n,t,r,e){w.isFunction(t)&&(e=r,r=t,t=!1);var u=r?w.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:w.contains(a,r))||(a.push(r),i.push(n[e]))}),i},w.union=function(){return w.uniq(c.apply(e,arguments))},w.intersection=function(n){var t=o.call(arguments,1);return w.filter(w.uniq(n),function(n){return w.every(t,function(t){return w.indexOf(t,n)>=0})})},w.difference=function(n){var t=c.apply(e,o.call(arguments,1));return w.filter(n,function(n){return!w.contains(t,n)})},w.zip=function(){for(var n=o.call(arguments),t=w.max(w.pluck(n,"length")),r=new Array(t),e=0;t>e;e++)r[e]=w.pluck(n,""+e);return r},w.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},w.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=w.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},w.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},w.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i},w.bind=function(n,t){if(n.bind===j&&j)return j.apply(n,o.call(arguments,1));var r=o.call(arguments,2);return function(){return n.apply(t,r.concat(o.call(arguments)))}},w.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},w.bindAll=function(n){var t=o.call(arguments,1);return 0===t.length&&(t=w.functions(n)),A(t,function(t){n[t]=w.bind(n[t],n)}),n},w.memoize=function(n,t){var r={};return t||(t=w.identity),function(){var e=t.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},w.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},w.defer=function(n){return w.delay.apply(w,[n,1].concat(o.call(arguments,1)))},w.throttle=function(n,t){var r,e,u,i,a=0,o=function(){a=new Date,u=null,i=n.apply(r,e)};return function(){var c=new Date,l=t-(c-a);return r=this,e=arguments,0>=l?(clearTimeout(u),u=null,a=c,i=n.apply(r,e)):u||(u=setTimeout(o,l)),i}},w.debounce=function(n,t,r){var e,u;return function(){var i=this,a=arguments,o=function(){e=null,r||(u=n.apply(i,a))},c=r&&!e;return clearTimeout(e),e=setTimeout(o,t),c&&(u=n.apply(i,a)),u}},w.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},w.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},w.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},w.after=function(n,t){return 0>=n?t():function(){return--n<1?t.apply(this,arguments):void 0}},w.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)w.has(n,r)&&(t[t.length]=r);return t},w.values=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push(n[r]);return t},w.pairs=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push([r,n[r]]);return t},w.invert=function(n){var t={};for(var r in n)w.has(n,r)&&(t[n[r]]=r);return t},w.functions=w.methods=function(n){var t=[];for(var r in n)w.isFunction(n[r])&&t.push(r);return t.sort()},w.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},w.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},w.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)w.contains(r,u)||(t[u]=n[u]);return t},w.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)null==n[r]&&(n[r]=t[r])}),n},w.clone=function(n){return w.isObject(n)?w.isArray(n)?n.slice():w.extend({},n):n},w.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof w&&(n=n._wrapped),t instanceof w&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;r.push(n),e.push(t);var a=0,o=!0;if("[object Array]"==u){if(a=n.length,o=a==t.length)for(;a--&&(o=S(n[a],t[a],r,e)););}else{var c=n.constructor,f=t.constructor;if(c!==f&&!(w.isFunction(c)&&c instanceof c&&w.isFunction(f)&&f instanceof f))return!1;for(var s in n)if(w.has(n,s)&&(a++,!(o=w.has(t,s)&&S(n[s],t[s],r,e))))break;if(o){for(s in t)if(w.has(t,s)&&!a--)break;o=!a}}return r.pop(),e.pop(),o};w.isEqual=function(n,t){return S(n,t,[],[])},w.isEmpty=function(n){if(null==n)return!0;if(w.isArray(n)||w.isString(n))return 0===n.length;for(var t in n)if(w.has(n,t))return!1;return!0},w.isElement=function(n){return!(!n||1!==n.nodeType)},w.isArray=x||function(n){return"[object Array]"==l.call(n)},w.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){w["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),w.isArguments(arguments)||(w.isArguments=function(n){return!(!n||!w.has(n,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(n){return"function"==typeof n}),w.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},w.isNaN=function(n){return w.isNumber(n)&&n!=+n},w.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},w.isNull=function(n){return null===n},w.isUndefined=function(n){return void 0===n},w.has=function(n,t){return f.call(n,t)},w.noConflict=function(){return n._=t,this},w.identity=function(n){return n},w.times=function(n,t,r){for(var e=Array(n),u=0;n>u;u++)e[u]=t.call(r,u);return e},w.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=w.invert(I.escape);var M={escape:new RegExp("["+w.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+w.keys(I.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(n){w[n]=function(t){return null==t?"":(""+t).replace(M[n],function(t){return I[n][t]})}}),w.result=function(n,t){if(null==n)return null;var r=n[t];return w.isFunction(r)?r.call(n):r},w.mixin=function(n){A(w.functions(n),function(t){var r=w[t]=n[t];w.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,r.apply(w,n))}})};var N=0;w.uniqueId=function(n){var t=++N+"";return n?n+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(n,t,r){var e;r=w.defaults({},r,w.templateSettings);var u=new RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(B,function(n){return"\\"+q[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,w);var c=function(n){return e.call(this,n,w)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},w.chain=function(n){return w(n).chain()};var D=function(n){return this._chain?w(n).chain():n};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];w.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],D.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];w.prototype[n]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);
(function(){var t,e=this,i=e.Backbone,s=[],n=s.push,r=s.slice,a=s.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.0.0";var o=e._;o||"undefined"==typeof require||(o=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var h=t.Events={on:function(t,e,i){if(!c(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var s=this._events[t]||(this._events[t]=[]);return s.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var s=this,n=o.once(function(){s.off(t,n),e.apply(this,arguments)});return n._callback=e,this.on(t,n,i)},off:function(t,e,i){var s,n,r,a,h,u,l,d;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:o.keys(this._events),h=0,u=a.length;u>h;h++)if(t=a[h],r=this._events[t]){if(this._events[t]=s=[],e||i)for(l=0,d=r.length;d>l;l++)n=r[l],(e&&e!==n.callback&&e!==n.callback._callback||i&&i!==n.context)&&s.push(n);s.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!c(this,"trigger",t,e))return this;var i=this._events[t],s=this._events.all;return i&&l(i,e),s&&l(s,arguments),this},stopListening:function(t,e,i){var s=this._listeners;if(!s)return this;var n=!e&&!i;"object"==typeof e&&(i=this),t&&((s={})[t._listenerId]=t);for(var r in s)s[r].off(e,i,this),n&&delete this._listeners[r];return this}},u=/\s+/,c=function(t,e,i,s){if(!i)return!0;if("object"==typeof i){for(var n in i)t[e].apply(t,[n,i[n]].concat(s));return!1}if(u.test(i)){for(var r=i.split(u),a=0,o=r.length;o>a;a++)t[e].apply(t,[r[a]].concat(s));return!1}return!0},l=function(t,e){var i,s=-1,n=t.length,r=e[0],a=e[1],o=e[2];switch(e.length){case 0:for(;++s<n;)(i=t[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=t[s]).callback.call(i.ctx,r);return;case 2:for(;++s<n;)(i=t[s]).callback.call(i.ctx,r,a);return;case 3:for(;++s<n;)(i=t[s]).callback.call(i.ctx,r,a,o);return;default:for(;++s<n;)(i=t[s]).callback.apply(i.ctx,e)}},d={listenTo:"on",listenToOnce:"once"};o.each(d,function(t,e){h[e]=function(e,i,s){var n=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=o.uniqueId("l"));return n[r]=e,"object"==typeof i&&(s=this),e[t](i,s,this),this}}),h.bind=h.on,h.unbind=h.off,o.extend(t,h);var f=t.Model=function(t,e){var i,s=t||{};e||(e={}),this.cid=o.uniqueId("c"),this.attributes={},o.extend(this,o.pick(e,p)),e.parse&&(s=this.parse(s,e)||{}),(i=o.result(this,"defaults"))&&(s=o.defaults({},s,i)),this.set(s,e),this.changed={},this.initialize.apply(this,arguments)},p=["url","urlRoot","collection"];o.extend(f.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return o.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var s,n,r,a,h,u,c,l;if(null==t)return this;if("object"==typeof t?(n=t,i=e):(n={})[t]=e,i||(i={}),!this._validate(n,i))return!1;r=i.unset,h=i.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=o.clone(this.attributes),this.changed={}),l=this.attributes,c=this._previousAttributes,this.idAttribute in n&&(this.id=n[this.idAttribute]);for(s in n)e=n[s],o.isEqual(l[s],e)||a.push(s),o.isEqual(c[s],e)?delete this.changed[s]:this.changed[s]=e,r?delete l[s]:l[s]=e;if(!h){a.length&&(this._pending=!0);for(var d=0,f=a.length;f>d;d++)this.trigger("change:"+a[d],this,l[a[d]],i)}if(u)return this;if(!h)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,o.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!o.isEmpty(this.changed):o.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1;var e,i=!1,s=this._changing?this._previousAttributes:this.attributes;for(var n in t)o.isEqual(s[n],e=t[n])||((i||(i={}))[n]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(s){return e.set(e.parse(s,t),t)?(i&&i(e,s,t),void e.trigger("sync",e,s,t)):!1},R(this,t),this.sync("read",this,t)},save:function(t,e,i){var s,n,r,a=this.attributes;if(null==t||"object"==typeof t?(s=t,i=e):(s={})[t]=e,!(!s||i&&i.wait||this.set(s,i)))return!1;if(i=o.extend({validate:!0},i),!this._validate(s,i))return!1;s&&i.wait&&(this.attributes=o.extend({},a,s)),void 0===i.parse&&(i.parse=!0);var h=this,u=i.success;return i.success=function(t){h.attributes=a;var e=h.parse(t,i);return i.wait&&(e=o.extend(s||{},e)),o.isObject(e)&&!h.set(e,i)?!1:(u&&u(h,t,i),void h.trigger("sync",h,t,i))},R(this,i),n=this.isNew()?"create":i.patch?"patch":"update","patch"===n&&(i.attrs=s),r=this.sync(n,this,i),s&&i.wait&&(this.attributes=a),r},destroy:function(t){t=t?o.clone(t):{};var e=this,i=t.success,s=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&s(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;R(this,t);var n=this.sync("delete",this,t);return t.wait||s(),n},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||U();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},o.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=o.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,o.extend(e||{},{validationError:i})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];o.each(g,function(t){f.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.attributes),o[t].apply(o,e)}});var v=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,o.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};o.extend(v.prototype,h,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.defaults(e||{},y))},remove:function(t,e){t=o.isArray(t)?t.slice():[t],e||(e={});var i,s,n,r;for(i=0,s=t.length;s>i;i++)r=this.get(t[i]),r&&(delete this._byId[r.id],delete this._byId[r.cid],n=this.indexOf(r),this.models.splice(n,1),this.length--,e.silent||(e.index=n,r.trigger("remove",r,this,e)),this._removeReference(r));return this},set:function(t,e){e=o.defaults(e||{},m),e.parse&&(t=this.parse(t,e)),o.isArray(t)||(t=t?[t]:[]);var i,s,r,h,u,c=e.at,l=this.comparator&&null==c&&e.sort!==!1,d=o.isString(this.comparator)?this.comparator:null,f=[],p=[],g={};for(i=0,s=t.length;s>i;i++)(r=this._prepareModel(t[i],e))&&((h=this.get(r))?(e.remove&&(g[h.cid]=!0),e.merge&&(h.set(r.attributes,e),l&&!u&&h.hasChanged(d)&&(u=!0))):e.add&&(f.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)));if(e.remove){for(i=0,s=this.length;s>i;++i)g[(r=this.models[i]).cid]||p.push(r);p.length&&this.remove(p,e)}if(f.length&&(l&&(u=!0),this.length+=f.length,null!=c?a.apply(this.models,[c,0].concat(f)):n.apply(this.models,f)),u&&this.sort({silent:!0}),e.silent)return this;for(i=0,s=f.length;s>i;i++)(r=f[i]).trigger("add",r,this,e);return u&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var i=0,s=this.models.length;s>i;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return o.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),o.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(o.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,i){e||(e=this.comparator);var s=o.isFunction(e)?e:function(t){return t.get(e)};return o.sortedIndex(this.models,t,s,i)},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(s){var n=t.reset?"reset":"set";i[n](s,t),e&&e(i,s,t),i.trigger("sync",i,s,t)},R(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?o.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,s=e.success;return e.success=function(n){e.wait&&i.add(t,e),s&&s(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var i=new this.model(t,e);return i._validate(t,e)?i:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,s){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,s),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];o.each(_,function(t){v.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.models),o[t].apply(o,e)}});var b=["groupBy","countBy","sortBy"];o.each(b,function(t){v.prototype[t]=function(e,i){var s=o.isFunction(e)?e:function(t){return t.get(e)};return o[t](this.models,s,i)}});var w=t.View=function(t){this.cid=o.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName","events"];o.extend(w.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=o.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(o.isFunction(i)||(i=this[t[e]]),i){var s=e.match(x),n=s[1],r=s[2];i=o.bind(i,this),n+=".delegateEvents"+this.cid,""===r?this.$el.on(n,i):this.$el.on(n,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=o.extend({},o.result(this,"options"),t)),o.extend(this,o.pick(t,E)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(o.result(this,"el"),!1);else{var e=o.extend({},o.result(this,"attributes"));this.id&&(e.id=o.result(this,"id")),this.className&&(e["class"]=o.result(this,"className"));var i=t.$("<"+o.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,s){var n=k[e];o.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:n,dataType:"json"};if(s.url||(r.url=o.result(i,"url")||U()),null!=s.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(s.attrs||i.toJSON(s))),s.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),s.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){r.type="POST",s.emulateJSON&&(r.data._method=n);var a=s.beforeSend;s.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",n),a?a.apply(this,arguments):void 0}}"GET"===r.type||s.emulateJSON||(r.processData=!1),"PATCH"!==r.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var h=s.xhr=t.ajax(o.extend(r,s));return i.trigger("request",i,h,s),h};var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},$=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,H=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;o.extend(S.prototype,h,{initialize:function(){},route:function(e,i,s){o.isRegExp(e)||(e=this._routeToRegExp(e)),o.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var n=this;return t.history.route(e,function(r){var a=n._extractParameters(e,r);s&&s.apply(n,a),n.trigger.apply(n,["route:"+i].concat(a)),n.trigger("route",i,a),t.history.trigger("route",n,i,a)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=o.result(this,"routes");for(var t,e=o.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace($,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/]+)"}).replace(H,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return o.map(i,function(t){return t?decodeURIComponent(t):null})}});var I=t.History=function(){this.handlers=[],o.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,O=/msie [\w.]+/,C=/\/$/;I.started=!1,o.extend(I.prototype,h,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,"");t.indexOf(i)||(t=t.substr(i.length))}else t=this.getHash();return t.replace(N,"")},start:function(e){if(I.started)throw new Error("Backbone.history has already been started");I.started=!0,this.options=o.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),s=document.documentMode,n=O.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);this.root=("/"+this.root+"/").replace(P,"/"),n&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location,a=r.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&r.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),I.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),i=o.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return i},navigate:function(t,e){if(!I.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var i=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,i){if(i){var s=t.href.replace(/(javascript:|#).*$/,"");t.replace(s+"#"+e)}else t.hash="#"+e}}),t.history=new I;var j=function(t,e){var i,s=this;i=t&&o.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},o.extend(i,s,e);var n=function(){this.constructor=i};return n.prototype=s.prototype,i.prototype=new n,t&&o.extend(i.prototype,t),i.__super__=s.prototype,i};f.extend=v.extend=S.extend=w.extend=I.extend=j;var U=function(){throw new Error('A "url" property or function must be specified')},R=function(t,e){var i=e.error;e.error=function(s){i&&i(t,s,e),t.trigger("error",t,s,e)}}}).call(this);
var XD=function(){var e,t,n,a=1,s=this;return{postMessage:function(e,t,n){t&&(n=n||parent,s.postMessage?n.postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):t&&(n.location=t.replace(/#.*$/,"")+"#"+ +new Date+a++ +"&"+e))},receiveMessage:function(a,o){s.postMessage?(a&&(n=function(e){return"string"==typeof o&&e.origin!==o||"[object Function]"===Object.prototype.toString.call(o)&&o(e.origin)===!1?!1:void a(e)}),s.addEventListener?s[a?"addEventListener":"removeEventListener"]("message",n,!1):s[a?"attachEvent":"detachEvent"]("onmessage",n)):(e&&clearInterval(e),e=null,a&&(e=setInterval(function(){var e=document.location.hash,n=/^#?\d+&/;e!==t&&n.test(e)&&(t=e,a({data:e.replace(n,"")}))},100)))}}}();
var Curalate=Curalate||{};Curalate.config=Curalate.config||{},Curalate.config.DOMAIN="edge.curalate.com";
var Curalate=Curalate||{};Curalate.config=Curalate.config||{},Curalate.config.API_VERSION="v1";
var Curalate=Curalate||{};Object.hasOwnProperty("create")||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],a=arguments[1],o=0;r>o;o++)if(o in t){var i=t[o];e.call(a,i,o,t)&&n.push(i)}return n}),Curalate.getProtocol=function(){return"https:"===document.location.protocol?"https:":"http:"},Curalate.getByElementOrId=function(e){var t;if("string"==typeof e){if(t=e,e=document.getElementById(e),!e)throw new Error("No element matches the ID: "+t)}else if("undefined"==typeof e)throw new Error("An element or element ID must be defined.");return e},Curalate.isValidEmail=function(e){var t="[^\\x0d\\x22\\x5c\\x80-\\xff]",r="[^\\x0d\\x5b-\\x5d\\x80-\\xff]",n="[^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+",a="\\x5c[\\x00-\\x7f]",o="\\x5b("+r+"|"+a+")*\\x5d",i="\\x22("+t+"|"+a+")*\\x22",u=n,c="("+u+"|"+o+")",s="("+n+"|"+i+")",l=c+"(\\x2e"+c+")*",h=s+"(\\x2e"+s+")*",x=h+"\\x40"+l,f="^"+x+"$",d=new RegExp(f);return d.test(e)},Curalate.showErrors=function(e,t){var r,n="";if("string"==typeof e&&(e=[e]),1===e.length)t.html(e[0]).show();else{for(r=0;r<e.length;r++)n+='<li tabindex="1">'+e[r]+"</li>";t.html("There are some problems: <ul>"+n+"</ul>").show()}},Curalate.parseQueryString=function(){var e,t,r={},n=window.location.search.substr(1).split("&");for(e=0;e<n.length;e++)t=n[e].split("="),t[0]&&(r[t[0]]=1===t.length?"":decodeURIComponent(t[1]));return r},Curalate.base64Encode=function(e){return window.btoa?window.btoa(unescape(encodeURIComponent(e))):Curalate.base64.encode(unescape(encodeURIComponent(e)))},Curalate.base64Decode=function(e,t){return t&&(e=decodeURIComponent(e)),decodeURIComponent(window.atob?escape(window.atob(e)):escape(Curalate.base64.decode(e)))},Curalate.isMobileRequest=function(){return navigator&&navigator.userAgent&&navigator.userAgent.match(/Symbian|Mobile|Android|BlackBerry/)?!0:!1},Curalate.generateGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)})};var setCookie=function(e,t,r){var n=new Date;n.setTime(n.getTime()+r);var a,o=n.toGMTString(),i=document.domain.split(".");a=-1!==["co","com"].indexOf(i[i.length-2])?"."+i.slice(-3).join("."):"."+i.slice(-2).join(".");var u=e+"="+t+";expires="+o+";domain="+a+";path=/";document.cookie=u},getCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var a=r[n];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""};Curalate.getOrSetFirstPartyCuid=function(e){var t=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var a=r[n];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""},r=t(e),n=r?r:Curalate.generateGuid(),a=new Date;a.setTime(a.getTime()+31536e6);var o,i=a.toGMTString(),u=document.domain.split(".");o=-1!==["co","com"].indexOf(u[u.length-2])?"."+u.slice(-3).join("."):"."+u.slice(-2).join(".");var c=e+"="+n+";expires="+i+";domain="+o+";path=/";return document.cookie=c,n},Curalate.getFirstPartyExperiment=function(e){var t,r=getCookie(e).split("-");return 2===r.length&&(t={eid:r[0],vid:r[1]}),t},Curalate.setFirstPartyExperiment=function(e,t){t?setCookie(e,t.eid+"-"+t.vid,6048e5):setCookie(e,"",-6048e5)},Curalate.trackingId=Curalate.generateGuid(),Curalate.Promise=function(){this.onSuccessHandler=function(){},this.onFailureHandler=function(){}},Curalate.Promise.prototype.success=function(e){return this.onSuccessHandler=e,this},Curalate.Promise.prototype.failure=function(e){return this.onFailureHandler=e,this},Curalate.base64={},Curalate.base64.PADCHAR="=",Curalate.base64.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Curalate.base64.makeDOMException=function(){try{return new DOMException(DOMException.INVALID_CHARACTER_ERR)}catch(e){var t=new Error("DOM Exception 5");return t.code=t.number=5,t.name=t.description="INVALID_CHARACTER_ERR",t.toString=function(){return"Error: "+t.name+": "+t.message},t}},Curalate.base64.getbyte64=function(e,t){var r=Curalate.base64.ALPHA.indexOf(e.charAt(t));if(-1===r)throw Curalate.base64.makeDOMException();return r},Curalate.base64.decode=function(e){e=""+e;var t,r,n,a=Curalate.base64.getbyte64,o=e.length;if(0===o)return e;if(o%4!==0)throw Curalate.base64.makeDOMException();t=0,e.charAt(o-1)===Curalate.base64.PADCHAR&&(t=1,e.charAt(o-2)===Curalate.base64.PADCHAR&&(t=2),o-=4);var i=[];for(r=0;o>r;r+=4)n=a(e,r)<<18|a(e,r+1)<<12|a(e,r+2)<<6|a(e,r+3),i.push(String.fromCharCode(n>>16,n>>8&255,255&n));switch(t){case 1:n=a(e,r)<<18|a(e,r+1)<<12|a(e,r+2)<<6,i.push(String.fromCharCode(n>>16,n>>8&255));break;case 2:n=a(e,r)<<18|a(e,r+1)<<12,i.push(String.fromCharCode(n>>16))}return i.join("")},Curalate.base64.getbyte=function(e,t){var r=e.charCodeAt(t);if(r>255)throw Curalate.base64.makeDOMException();return r},Curalate.base64.encode=function(e){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var t,r,n=Curalate.base64.PADCHAR,a=Curalate.base64.ALPHA,o=Curalate.base64.getbyte,i=[];e=""+e;var u=e.length-e.length%3;if(0===e.length)return e;for(t=0;u>t;t+=3)r=o(e,t)<<16|o(e,t+1)<<8|o(e,t+2),i.push(a.charAt(r>>18)),i.push(a.charAt(r>>12&63)),i.push(a.charAt(r>>6&63)),i.push(a.charAt(63&r));switch(e.length-u){case 1:r=o(e,t)<<16,i.push(a.charAt(r>>18)+a.charAt(r>>12&63)+n+n);break;case 2:r=o(e,t)<<16|o(e,t+1)<<8,i.push(a.charAt(r>>18)+a.charAt(r>>12&63)+a.charAt(r>>6&63)+n)}return i.join("")};
var Curalate=Curalate||{};Curalate.tracking=function(e){function t(e,t){this.code=e,this.target=t}function i(e,i){t.call(this,e,i),this.type="dwell"}function n(e,i){t.call(this,e,i),this.type="impression"}function r(e,i){t.call(this,e,i),this.type="viewable-impression"}function o(e,i){t.call(this,e,i),this.type="click"}var a,d,c,s="data-tracking-click",l="data-tracking-click-deferred",u="data-tracking-hover",h="data-tracking-product-id",m=1e3,f=1e3,v=1e4,g=["DOMContentLoaded","load","scroll","resize"],w=["onreadystatechange","onload","onscroll","onresize"],p=/fr\.(.+)/,b=/item-(.+)/,y=/product-(.+)/,T={},E=[],k=function(e){var t,i,n,o,d,c;if(a&&(a.endTime=(new Date).getTime(),a.isMeasurable()?(o=a.code,d=a.target,M(a),a=new r(o,d),L(a)):a.endTime=null),0!==E.length){for(i=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/tracking/events.png?r="+Math.floor(1e5*Math.random()),t=0;t<E.length;t++)c=E[t],"dwell"===c.type&&c.target&&D(c.code,"hover",c.target,null,c.endTime-c.startTime),i+="&e="+encodeURIComponent(c.serialize());n=new Image(1,1),n.src=i,n.style.display="none","function"==typeof e&&(n.onload=e,n.onerror=e),document.body.appendChild(n),E=[]}},C=(setInterval(k,v),function(e){var t=e.getBoundingClientRect(),i=t.bottom-t.top,n=t.right-t.left,r=i*n,o={height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},a={height:0,width:0};return 0===i||0===n||"none"===e.style.display||"hidden"===e.style.visibility?!1:t.top>o.height?!1:t.bottom<0?!1:(a.height=t.top>0?i-Math.max(t.bottom-o.height,0):i+t.top,t.left>o.width?!1:t.right<0?!1:(a.width=t.left>0?n-Math.max(t.right-o.width,0):n+t.left,a.width*a.height>=r/2||a.width*a.height/(o.width*o.height)>=.5))}),L=function(e){var t=[e.code,e.target,e.type];e.startTime=(new Date).getTime(),T[t]=e},M=function(e){var t=[e.code,e.target,e.type];T[t]&&(delete T[t],e.endTime=(new Date).getTime(),e.isMeasurable()&&E.push(e))},I=function(){var e=[];for(var t in T)e.push(T[t]),M(T[t]);return a=null,e},z=function(e){return e.replace(/\|/g,"")},D=function(e,t,i,n,r){var o,a,d,c,s=b.test(i),l=y.test(i),u="rid=",h="iid=",m="prid=",f="dt=",v="",g="v1:";if(window.Curalate&&window.Curalate.cfgTraffic&&(o=Curalate.cfgTraffic,p.test(e))){switch(a="curalate.fanreel."+p.exec(e)[1],n=n?y.exec(n)[1]:"",s?c=b.exec(i)[1]:l&&(c=y.exec(i)[1]),c=c?encodeURIComponent(c):c,n=encodeURIComponent(n),t){case"impression":c||(d="reel.impression",g+=u+Curalate.tracking.requestId);break;case"hover":c&&(d="item.hover",g+=h+c+"&"+m+n+"&"+f+v);break;case"click":c&&(d=l?"item.shop":"item.click",g+=h+c+"&"+m+n+"&"+f+v)}if(d)try{o._gaq?o._gaq.push(["_trackEvent",a,d,g,r]):o.ga&&o.ga("send","event",a,d,g,r)}catch(w){window.console&&console.log&&console.log("Unable to send traffic event:"+w.message)}}};return t.prototype.isMeasurable=function(){throw new Error("Method must be implemented by subclass")},t.prototype.serialize=function(){var e;if(!this.startTime||!this.endTime)throw new Error("A start time and end time for this event must be established before recording this event.");if(!this.type)throw new Error("Tracking event must define a 'type' field in order to be recorded.");if(!this.code)throw new Error("Tracking event must define a 'code' field in order to be recorded.");return e="code:"+z(this.code)+"|type:"+z(this.type)+"|uuid:"+Curalate.trackingId+"|time:"+(this.endTime-this.startTime),this.target&&(e+="|target:"+z(this.target)),e},i.prototype=Object.create(t.prototype),i.prototype.isMeasurable=function(){if(!this.startTime||!this.endTime)throw new Error("A start time and end time for this event must be established before recording this event.");return this.endTime-this.startTime>f},n.prototype=Object.create(t.prototype),n.prototype.isMeasurable=function(){return!0},r.prototype=Object.create(t.prototype),r.prototype.isMeasurable=function(){if(!this.startTime||!this.endTime)throw new Error("A start time and end time for this event must be established before recording this event.");return this.endTime-this.startTime>m},o.prototype=Object.create(t.prototype),o.prototype.isMeasurable=function(){return!0},{recordImpression:function(e,t){var i=new n(e,t),r=(new Date).getTime();i.startTime=r,i.endTime=r,E.push(i),D(e,"impression"),k()},recordClick:function(e,t,i,n,r){var a,d=new o(e,t),c=(new Date).getTime(),s=[];for(d.startTime=d.endTime=c,E.push(d),D(e,"click",t,r),s=I(),i?k(function(){window.location.href=n}):k(),a=0;a<s.length;a++)d=s[a],d.startTime=null,d.endTime=null,L(d)},initializeClickTracker:function(t){e("html").on("click","["+s+"], ["+l+"]",function(i){var n=e(this),r=n.attr(l)||n.attr(s),o=n.attr(l)?!0:!1,a=n.attr("href"),d=n.attr(h);return o&&i.preventDefault(),Curalate.tracking.recordClick(t,r,o,a,d),!0})},initializeDwellTracker:function(t){var n=e("html");n.on("mouseenter","["+u+"]",function(){var n=e(this),r=n.attr(u),o=new i(t,r);L(o),n.data("generated-event",o)}),n.on("mouseleave","["+u+"]",function(){var t=e(this),i=t.data("generated-event");i&&(M(i),t.removeData("generated-event"))})},initializeVisibilityTracker:function(e,t,i,n){var o,s=document.getElementById(e);if(d){if(window.removeEventListener)for(window.removeEventListener("focus",d,!0),window.removeEventListener("blur",I,!0),o=0;o<g.length;o++)window.removeEventListener(g[o],d);else for(document.detachEvent("onfocusin",d),document.detachEvent("onfocusout",I),o=0;o<w.length;o++)window.detachEvent(w[o],d);document.visibilityState?document.removeEventListener("visibilitychange",c,!0):document.webkitVisibilityState?document.removeEventListener("webkitvisibilitychange",c,!0):document.mozVisibilityState?document.removeEventListener("mozvisibilitychange",c,!0):document.msVisibilityState&&document.removeEventListener("msvisibilitychange",c,!0),I()}if(d=function(){var e=C(s);e&&!a?(a=new r(t,i),L(a)):!e&&a&&(M(a),a=null)},window.addEventListener)for(o=0;o<g.length;o++)window.addEventListener(g[o],d);else if(window.attachEvent)for(o=0;o<w.length;o++)window.attachEvent(w[o],d);document.visibilityState?(c=function(){document.hidden?I():d()},document.addEventListener("visibilitychange",c,!0)):document.webkitVisibilityState?(c=function(){document.webkitHidden?I():d()},document.addEventListener("webkitvisibilitychange",c,!0)):document.mozVisibilityState?(c=function(){document.mozHidden?I():d()},document.addEventListener("mozvisibilitychange",c,!0)):document.msVisibilityState&&(c=function(){document.msHidden?I():d()},document.addEventListener("msvisibilitychange",c,!0)),window.addEventListener?(window.addEventListener("focus",d,!0),window.addEventListener("blur",I,!0)):(document.attachEvent("onfocusin",d),document.attachEvent("onfocusout",I)),n&&d()},requestId:Curalate.generateGuid()}}(Curalate.jQuery||jQuery);
!function(e,t){"use strict";function i(e,t){this.timestamp=e,this.requestId=t}function n(e,t,n,r,o){i.call(this,e,t),this.type=ue,this.displayType=n,this.userId=r,this.productId=o}function r(e,t,n,r,o){if(!o)throw new Error('Product No Content event must define an "productId" parameter to be recorded.');i.call(this,e,t),this.type=he,this.displayType=n,this.userId=r,this.productId=o}function o(e,t,n){if(!n)throw new Error('Page Viewable Impression event must define an "elapsedTime" parameter to be recorded.');i.call(this,e,t),this.type="pvi",this.elapsedTime=n}function a(e,t,n,r,o){if(!r)throw new Error('Item Click event must define an "itemId" parameter to be recorded.');i.call(this,e,t),this.type=fe,this.itemId=r,this.position=o,this.gaNonInteractive=n}function s(e,t,n,r,o,a){if(!o)throw new Error('Item Hover event must define an "itemId" parameter to be recorded.');if(!r)throw new Error('Item Hover event must define an "elapsedTime" parameter to be recorded.');i.call(this,e,t),this.type=me,this.elapsedTime=r,this.itemId=o,this.position=a,this.gaNonInteractive=n}function c(e,t,n,r,o){if(!r)throw new Error('Item Viewable Impression event must define an "itemId" parameter to be recorded.');if(!n)throw new Error('Item Viewable Impression event must define an "elapsedTime" parameter to be recorded.');i.call(this,e,t),this.type="ivi",this.elapsedTime=n,this.itemId=r,this.position=o}function d(e,t,n,r,o,a,s){if(!r)throw new Error('Product Click event must define an "itemId" parameter to be recorded.');if(!o)throw new Error('Product Click event must define an "productId" parameter to be recorded.');i.call(this,e,t),this.type=ye,this.itemId=r,this.productId=o,this.productStyleId=a,this.position=s,this.gaNonInteractive=n}function l(e,t,n,r,o,a,s,c){if(!o)throw new Error('Product Hover event must define an "itemId" parameter to be recorded.');if(!r)throw new Error('Product Hover event must define an "elapsedTime" parameter to be recorded.');if(!a)throw new Error('Product Hover event must define an "productId" parameter to be recorded.');i.call(this,e,t),this.type="prh",this.elapsedTime=r,this.itemId=o,this.productId=a,this.productStyleId=s,this.position=c,this.gaNonInteractive=n}function p(e,t,n,r,o,a,s){if(!r)throw new Error('Product Viewable Impression event must define an "itemId" parameter to be recorded.');if(!n)throw new Error('Product Viewable Impression event must define an "elapsedTime" parameter to be recorded.');if(!o)throw new Error('Product Viewable Impression event must define an "productId" parameter to be recorded.');i.call(this,e,t),this.type="prvi",this.elapsedTime=n,this.itemId=r,this.productId=o,this.productStyleId=a,this.position=s}function u(){e.visibilityState?(this.visibilityChangeEvent="visibilitychange",this.hidden="hidden"):e.webkitVisibilityState?(this.visibilityChangeEvent="webkitvisibilitychange",this.hidden="webkitHidden"):e.mozVisibilityState?(this.visibilityChangeEvent="mozvisibilitychange",this.hidden="mozHidden"):e.msVisibilityState&&(this.visibilityChangeEvent="msvisibilitychange",this.hidden="msHidden")}function h(e,t,i,n){this.item=e,this.itemId=t,this.timestamp=i,this.key=n}function m(){this.containerViewableStartTimes={}}function f(){this.containerHoverStartTimes={}}function y(){}function v(){this.isFanreelContainerVisible=!1}var I,w,b,g,T,C,E,x,k,V,S,j,H,q,P,_,R,U,F,z,O,A,N,L,Q,K,M,D,W,B,G,J,X=[],Y=[],Z=0,$=!0,ee=0,te=new y,ie=new f,ne=new m,re=new u,oe=new y,ae=new f,se=new m,ce="https://",de="e.curalate.com",le="v1",pe="v1:",ue="pi",he="pinc",me="ih",fe="ic",ye="prc",ve="crl8.fpcuid",Ie="pdp.",we={},be="rid=",ge="iid=",Te="prid=",Ce="dt=",Ee="data-curalate-view-tracking",xe="data-curalate-display-type",ke="data-curalate-item-click",Ve="data-curalate-item-id",Se="data-curalate-item-position",je="data-curalate-product-click",He="data-curalate-product-id",qe="data-curalate-product-style-id",Pe="data-curalate-product-position",_e=1e3,Re=15,Ue=1050,Fe=1e3,ze=30,Oe=1e3,Ae=1e4,Ne=500,Le=31536e6,Qe="*[data-curalate-item-container]",Ke="*["+ke+"]",Me="*[data-curalate-product-container]",De="*["+je+"]";we[ue]="reel.impression",we[me]="item.hover",we[fe]="item.click",we[ye]="item.shop",j=function(t){for(var i=t+"=",n=e.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(i))return o.substring(i.length,o.length)}return""},S=function(t){var i=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})},n=j(t),r=n?n:i(),o=new Date;o.setTime(o.getTime()+Le);var a,s=o.toGMTString(),c=e.domain.split(".");a=-1!==["co","com"].indexOf(c[c.length-2])?"."+c.slice(-3).join("."):"."+c.slice(-2).join(".");var d=t+"="+r+";expires="+s+";domain="+a+";path=/";return e.cookie=d,r},k=S(ve),z=e.referrer,P=function(e){var t,i=j("crl8.exprmt.reel."+e).split("-");return t=2===i.length?{eid:i[0],vid:i[1]}:""},w=function(e){var t,i,n=1,r=7,o=e,a=o.split(".");return a.length<2?!1:(t=parseInt(a[0],10),i=parseInt(a[1],10),t>n||t==n&&i>=r)},I=function(){return(new Date).getTime()},b=function(e,i,n){var r;return function(){function o(){n||e.apply(a,s),r=null}var a=this,s=arguments;r?t.clearTimeout(r):n&&e.apply(a,s),r=t.setTimeout(o,i||100)}},g=function(e){X.push(e),X.length>=Re&&N()},V=function(e){var t,i=I();ee&&(t=i-ee,t>=Oe&&g(new o(i,O,t)),e&&(ee=i)),ie.flushEvents(e),ne.flushEvents(e),ae.flushEvents(e),se.flushEvents(e)},N=function(t){var i,n=ce+de+"/api/"+le+"/metrics/reels/"+F+"/events.png?";if(0!==X.length){i=X[0].requestId,n+="rid="+i,n+="&fpcuid="+k,n+="&ref="+encodeURIComponent(A(z)),H=P(q),H&&(n+="&eid="+H.eid,n+="&vid="+H.vid),J.each(X,function(e,t){n+="&e="+encodeURIComponent(t.serialize(i)),L(t)});var r=e.createElement("img");r.src=n,r.style.position="absolute",r.style["z-index"]=-100,r.setAttribute("alt",""),r.setAttribute("aria-hidden",!0),e.body.appendChild(r),X=[]}},E=function(e){var t,e=J(e);return(t=e.attr(Ee))?t:(Z++,e.attr(Ee,Z),Z)},L=function(e){if(t.Curalate&&t.Curalate.cfgTraffic){var i,n,r=t.Curalate.cfgTraffic;Y.length&&(J.each(Y,function(e,t){n=t.displayType?encodeURIComponent(t.displayType):"",i=encodeURIComponent(t.requestId),D(t,r,i,n)}),Y=[]),we[e.type]&&(n=e.displayType?encodeURIComponent(e.displayType):"",i=encodeURIComponent(e.requestId),W(e,r,i,n),D(e,r,i,n))}else we[e.type]&&Y.push(e)},Q=function(e,t,i,n){var r=[];return e&&r.push(be+e),t&&r.push(ge+t),i&&r.push(Te+i),n&&r.push(Ce+n),pe+r.join("&")},D=function(e,t,i,n){var r,o,a,s,c,d,l=e.type,p=!!e.gaNonInteractive,u="curalate.fanreel."+F,h=e.elapsedTime;(t.ga||t._gaq)&&(l===ue?a=Q(i,"","",n):(r=e.itemId?encodeURIComponent(e.itemId):"",o=e.productId?encodeURIComponent(e.productId):"",s=Q("",r,"",n),(l===fe||l===ye)&&(c=Q("",r,"",n)),l===ye&&(d=Q("",r,o,n))),d&&M(t,u,we[ye],d,h,p),c&&M(t,u,we[fe],c,h,p),s&&M(t,u,we[me],s,h,p),a&&M(t,u,we[ue],a,h,!0))},M=function(e,i,n,r,o,a){try{e._gaq?e._gaq.push(["_trackEvent",i,n,r,o]):e.ga&&e.ga("send","event",i,n,r,o,{nonInteraction:a})}catch(s){t.console&&t.console.log&&console.log("Unable to send GA traffic event: "+s.message)}},K=function(e,t,i,n){var r,o,a,s;a="https://www.facebook.com/tr?id="+e+"&ev="+t,a+="&cd[reel_id]="+F,a+="&cd[curalate_channel]=fanreel",n&&(a+="&cd[curalate_display_type]="+n),i&&(s=J.map(i.content_ids,function(e){return encodeURIComponent('"'+e+'"')}).join(),a+="&cd[content_type]="+encodeURIComponent(i.content_type),a+="&cd[content_ids]=["+s+"]",a+="&cd[currency]="+encodeURIComponent(i.currency),a+="&cd[value]="+encodeURIComponent(i.value)),r=J("body"),o=J('<img width="1" height="1" style="display:none" src="'+a+'"/>'),r.append(o)},W=function(e,t,i,n){!B&&t.omni&&T&&T.c&&e.type!==ue&&(B=Q(i,"","",n),t.omni.send(T,B))},x=function(i){var n=i.getBoundingClientRect(),r=n.bottom-n.top,o=n.right-n.left,a=r*o,s={height:t.innerHeight||e.documentElement.clientHeight||e.body.clientHeight,width:t.innerWidth||e.documentElement.clientWidth||e.body.clientWidth},c={height:0,width:0};return 0===r||0===o||"none"===i.style.display||"hidden"===i.style.visibility?!1:n.top>s.height?!1:n.bottom<0?!1:(c.height=n.top>0?r-Math.max(n.bottom-s.height,0):r+n.top,n.left>s.width?!1:n.right<0?!1:(c.width=n.left>0?o-Math.max(n.right-s.width,0):o+n.left,c.width*c.height>=a/2||c.width*c.height/(s.width*s.height)>=.5))},A=function(e){return e.replace?e.replace(/\|/g,""):e},i.prototype.serialize=function(e){var t;if(!this.timestamp)throw new Error("Tracking event must define a 'timestamp' field in order to be recorded.");if(!this.requestId)throw new Error("Tracking event must define a 'requestId' field in order to be recorded.");if(!this.type)throw new Error("Tracking event must define a 'type' field in order to be recorded.");return t="t:"+A(this.type)+"|ts:"+A(this.timestamp),this.requestId!=e&&(t+="|rid:"+A(this.requestId)),this.elapsedTime&&(t+="|et:"+A(this.elapsedTime)),this.itemId&&(t+="|iid:"+A(this.itemId)),this.productId&&(t+="|pid:"+A(this.productId)),this.productStyleId&&(t+="|psid:"+A(this.productStyleId)),this.position&&(t+="|pos:"+A(this.position)),this.userId&&(t+="|uid:"+A(this.userId)),this.displayType&&(t+="|dt:"+A(this.displayType)),t},n.prototype=Object.create(i.prototype),r.prototype=Object.create(i.prototype),o.prototype=Object.create(i.prototype),a.prototype=Object.create(i.prototype),s.prototype=Object.create(i.prototype),c.prototype=Object.create(i.prototype),d.prototype=Object.create(i.prototype),l.prototype=Object.create(i.prototype),p.prototype=Object.create(i.prototype),u.prototype.init=function(t){var i=this;e.addEventListener(this.visibilityChangeEvent,function(){t(!e[i.hidden])},!0)},m.prototype.init=function(e,t){this.selector=e,this.viewableImpressionCallback=t},m.prototype.checkVisibility=function(){var e=this;J(e.selector).each(function(t,i){var n,r,o,a,s=J(i).attr(Ve),c=x(i),d=I();o=E(i),a=e.containerViewableStartTimes[o],n=!a&&c,r=a&&!c,n?e.setItemVisible(new h(i,s,d,o)):r&&e.setItemHidden(new h(i,s,d,o))})},m.prototype.setItemVisible=function(e){this.containerViewableStartTimes[e.key]=e},m.prototype.setItemHidden=function(e){var t=this,i=t.containerViewableStartTimes[e.key].timestamp,n=i?e.timestamp-i:Oe;n>=Oe&&t.viewableImpressionCallback(e.timestamp,e.itemId,e.item,n),delete t.containerViewableStartTimes[e.key]},m.prototype.flushEvents=function(e){var t=this,i=I();J.each(t.containerViewableStartTimes,function(n,r){var o=new h(r.item,r.itemId,i,r.key);t.setItemHidden(o),e&&(t.containerViewableStartTimes[o.key]=o)})},f.prototype.init=function(e,t){var i=this;i.hoverCompletedCallback=t,i.selector=e,G.on("mouseover mouseout",i.selector,function(e){var t=J(e.currentTarget),n=t.attr(Ve),r=I();switch(e.type){case"mouseover":i.hoverItem(new h(t,n,r));break;case"mouseout":i.unhoverItem(new h(t,n,r))}})},f.prototype.hoverItem=function(e){this.containerHoverStartTimes[e.itemId]=e},f.prototype.unhoverItem=function(e){if(this.containerHoverStartTimes[e.itemId]){var t=this.containerHoverStartTimes[e.itemId].timestamp,i=t?e.timestamp-t:Fe;i>=Fe&&this.hoverCompletedCallback(e.timestamp,e.itemId,e.item,i),delete this.containerHoverStartTimes[e.itemId]}},f.prototype.flushEvents=function(e){var t=this,i=I();J.each(t.containerHoverStartTimes,function(n,r){var o=new h(r.item,r.itemId,i);t.unhoverItem(o),e&&(t.containerHoverStartTimes[o.itemId]=o)})},y.prototype.init=function(i,n){J(e).on("mousedown",i,function(e){var i,r=J(e.currentTarget),o=r.attr(Ve),a=r.is("a"),s="undefined"!=typeof r.attr(je),c="undefined"!=typeof r.attr(ke),d="_blank"===r.attr("target"),l=I();n(r,o,l),i=r.attr("href"),(s||c)&&V();var p=1===e.which&&!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey);s&&a&&i&&p?(e.preventDefault(),d?(N(),t.open(i,"_blank")):N(function(){t.location.href=i})):(c||s)&&N()})},v.prototype.init=function(i){var n=this;if(!i)throw new Error('Curalate Fanreel Analytics must be initialized with a "config" parameter.');if(!i.fanreelId)throw new Error('Curalate Fanreel Analytics config must be initialized with a "fanreelId" parameter.');if(!i.containerId)throw new Error('Curalate Fanreel Analytics config must be initialized with a "containerId" parameter.');if(!i.requestId)throw new Error('Curalate Fanreel Analytics config must be initialized with a "requestId" parameter.');if(i.jQuery&&w(i.jQuery.fn.jquery))J=i.jQuery,U(n,i);else{var r=e.createElement("script");r.type="text/javascript",r.src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js",r.readyState?r.onreadystatechange=function(){("loaded"===r.readyState||"complete"===r.readyState)&&(r.onreadystatechange=null,J=t.jQuery.noConflict(!0),U(n,i))}:r.onload=function(){J=t.jQuery.noConflict(!0),U(n,i)},e.getElementsByTagName("head")[0].appendChild(r)}},U=function(i,u){var h,m,f,y,v,w,E,k,S,j,H,P,U,z,A,L,Q,M,D=u.userId,W=null;F=u.fanreelId,O=u.requestId,T=u.eVars,C=u.facebookAnalytics,Q=!u.noContent,M=u.pdpProductId,m=u.gaNonInteractive,G=J(e),L=J(u.containerId),h=u.displayType||L.attr(xe),q=M?Ie+F:F,w=function(){f||(j(),P(),k(),f=t.setInterval(function(){A(),V(!0),N()},Ae))},E=function(e){f&&(N(),e||H(),S(),t.clearInterval(f),f=null)},k=function(){W||(W=t.setInterval(function(){A()},Ne))},S=function(){W&&(t.clearInterval(W),W=null)},Q?(x(L[0])&&(i.isFanreelContainerVisible=!0,ee=I()),te.init(Qe+", "+Ke,function(e,t,i){var n=e.attr(Ve),r=e.attr(Se);g(new a(i,O,m,n,r))}),oe.init(De,function(e,t,i){var n=e.attr(Ve),r=e.attr(He),o=e.attr(qe),a=e.attr(Pe);g(new d(i,O,m,n,r,o,a))}),ie.init(Qe,function(e,t,i,n){var r=i.attr(Se);g(new s(e,O,m,n,t,r))}),ae.init(Me,function(e,t,i,n){var r=i.attr(He),o=i.attr(qe),a=i.attr(Pe);g(new l(e,O,m,n,t,r,o,a))}),ne.init(Qe,function(e,t,i,n){var r=J(i).attr(Se);g(new c(e,O,n,t,r))}),se.init(Me,function(e,t,i,n){var r=J(i).attr(He),o=J(i).attr(qe),a=J(i).attr(Pe);g(new p(e,O,n,t,r,o,a))}),g(new n(I(),O,h,D,M)),V(!0),N()):M&&(g(new r(I(),O,h,D,M)),V(!0),N()),A=b(function(){var e,n,r,a=i.isFanreelContainerVisible,s=I();i.isFanreelContainerVisible=x(L[0]),e=!a&&i.isFanreelContainerVisible,n=a&&!i.isFanreelContainerVisible,e?(ee=s,C&&C.enableFacebookPixel&&K(C.facebookPixelId,"PageView",null,h),$&&($=!1,t.setTimeout(function(){V(!0),N()},Ue))):n&&(r=ee?s-ee:Oe,r>=Oe&&g(new o(s,O,r)),ee=0),ne.checkVisibility(),se.checkVisibility()},50,!1),P=function(){J(t).on("load ready resize scroll",function(){A()})},R=function(){_++,_>=ze&&!v&&(U(!0),v=!0)},j=function(){y||(_=0,v=!1,y=t.setInterval(R,_e),J(t).on("mousemove keypress",function(){v&&z(),_=0,v=!1}))},H=function(){y&&(t.clearInterval(y),J(t).off("mousemove keypress"),y=null)},z=function(){w(),A()},U=function(e){V(),i.isFanreelContainerVisible=!1,E(e)},Q&&(re.init(function(e){e?z():U()}),t.addEventListener?(t.addEventListener("focus",z,!0),t.addEventListener("blur",function(e){e.target===t&&U()},!0),t.addEventListener("beforeunload",U)):(e.attachEvent("onfocusin",z),e.attachEvent("onfocusout",function(e){e.target===t&&U()}),e.attachEvent("beforeunload",U)),w())},v.prototype.recordConversion=function(){console.warn("This has been deprecated since 3/21/2017")},t.fanreelAnalytics=new v}(document,window);
var Curalate=Curalate||{};!function(){var e=50,t=5e3,r="curalate-photo-picker",o="crl8.fpcuid",a="crl8.exprmt.reel.",n="pdp.",i=31536e6,c=6048e5,l=!1,s=function(e){var t,r=[],o=function(e){return e.replace(/\\/g,"\\\\").replace(/:/g,"\\:").replace(/,/g,"\\,")};for(t in e)e.hasOwnProperty(t)&&r.push(e[t]&&e[t].trim().length>0?o(t)+":"+o(e[t]):o(t));return r.join(",")},d=function(e){if(!e)throw new Error("Configuration object must be passed as a parameter.");if(!e.code)throw new Error("Configuration object is missing the value 'code'");this.code=e.code,e.productId&&(this.productId=e.productId),e.locale&&(this.locale=e.locale),e.filterOperator&&(this.filterOperator=e.filterOperator),e.restoreQueryParams&&(this.restoreQueryParams=e.restoreQueryParams),this.firstPartyCuid=this.getOrSetFirstPartyCuid(o)},u=function(e){var t;"close-photo-picker"===e.data&&(t=document.getElementById(r),t.parentNode.removeChild(t),jQuery("#curalate-upload-photos").focus())};d.prototype.retrieve=function(r){var o,a,i,c,l,d,u,p,f="cb_"+Math.floor(1e6*Math.random()),h=new Curalate.Promise,I=!1;if(r=r||{},o=r.limit||e,!this.code)throw new Error("Unable to identify this Fan Reel");i=this.code,a=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/reels/"+i+".jsonp",a+="?callback=Curalate.FanReel.callbacks."+f,a+="&limit="+o,this.firstPartyCuid&&(a+="&fpcuid="+this.firstPartyCuid),r.bookmark&&(a+="&bookmark="+r.bookmark),p="",this.productId&&(a+="&productId="+encodeURIComponent(this.productId),p=n),r.locale&&(a+="&locale="+encodeURIComponent(r.locale)),r.filterOperator&&(a+="&filterOperator="+encodeURIComponent(r.filterOperator)),r.sortValue&&(a+="&sort="+encodeURIComponent(r.sortValue)),r.filters&&(a+="&filters="+encodeURIComponent(s(r.filters))),r.metadata&&(u=encodeURIComponent("object"==typeof r.metadata?r.metadata.join(","):r.metadata),a+="&metadata="+u),r.requestId&&(a+="&rid="+encodeURIComponent(r.requestId)),r.forceModernProducts&&(a+="&forceModernProducts=true"),r.crl8&&r.crl8.id&&(a+="&crl8_id="+encodeURIComponent(r.crl8.id));var g=Curalate.parseQueryString();if(g.ctid&&!isNaN(g.ctid)&&(a+="&ctid="+g.ctid),r.appId&&(a+="&app="+encodeURIComponent(r.appId)),m()){var C=this.getFirstPartyExperiment(p+i);C&&(a+="&eid="+C.eid,a+="&vid="+C.vid)}return l=setTimeout(function(){I=!0,h.onFailureHandler("Request timed out")},t),c=this,Curalate.FanReel.callbacks[f]=function(e){I||(clearTimeout(l),e.errorMessage?h.onFailureHandler(e.errorMessage):(m()&&c.setFirstPartyExperiment(p+i,e.experimentInfo),h.onSuccessHandler(e)))},d=document.createElement("script"),d.setAttribute("type","text/javascript"),d.setAttribute("src",a),document.body.appendChild(d),h},d.prototype.retrieveItemById=function(e){var r,o,a,n,i="cb_"+Math.floor(1e6*Math.random()),c=new Curalate.Promise,l=!1;if(e=e||{},!this.code)throw new Error("Unable to identify this Fan Reel");return r=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/reels/"+this.code+"/"+e.id+".jsonp",r+="?callback=Curalate.FanReel.callbacks."+i,this.firstPartyCuid&&(r+="&fpcuid="+this.firstPartyCuid),e.productId&&(r+="&productId="+encodeURIComponent(e.productId)),e.locale&&(r+="&locale="+encodeURIComponent(e.locale)),e.filterOperator&&(r+="&filterOperator="+encodeURIComponent(e.filterOperator)),e.sortValue&&(r+="&sort="+encodeURIComponent(e.sortValue)),e.filters&&(r+="&filters="+encodeURIComponent(s(e.filters))),e.crl8&&e.crl8.id&&(r+="&crl8_id="+encodeURIComponent(e.crl8.id)),e.metadata&&(n=encodeURIComponent("object"==typeof e.metadata?e.metadata.join(","):e.metadata),r+="&metadata="+n),e.forceModernProducts&&(r+="&forceModernProducts=true"),e.appId&&(r+="&app="+encodeURIComponent(e.appId)),o=setTimeout(function(){l=!0,c.onFailureHandler("Request timed out")},t),Curalate.FanReel.callbacks[i]=function(e){l||(clearTimeout(o),e.errorMessage?c.onFailureHandler(e.errorMessage):c.onSuccessHandler(e))},a=document.createElement("script"),a.setAttribute("type","text/javascript"),a.setAttribute("src",r),document.body.appendChild(a),c},d.prototype.showPhotoPicker=function(e){var t,o,e=e||{};Curalate.isMobileRequest()?(o=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/reels/"+this.code+"/photo-picker-mobile?",e.locale&&(o+="&locale="+e.locale),e.restoreQueryParams&&(o+="&restoreQueryParams="+e.restoreQueryParams),e.productId&&(o+="&productId="+e.productId),window.open(o,"","")):(o=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/reels/"+this.code+"/photo-picker?source="+encodeURIComponent(window.location.href),e.locale&&(o+="&locale="+e.locale),e.restoreQueryParams&&(o+="&restoreQueryParams="+e.restoreQueryParams),e.productId&&(o+="&productId="+e.productId),l||(XD.receiveMessage(u,Curalate.getProtocol()+"//"+Curalate.config.DOMAIN),l=!0),t=document.createElement("iframe"),t.id=r,t.src=o,t.scrolling="no",t.frameBorder="0",t.allowTransparency="true",t.style.cssText="border: 0 none; overflow: hidden; position: fixed; margin: 0; padding: 0; top: 0; left: 0; right: 0; bottom: 0; height: 100%; width: 100%; z-index: 1040;",document.body.appendChild(t))},d.prototype.makeRegisterVoteRequest=function(e){var t;if(!this.contestId)throw new Error("Contest ID not found");return t=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/contest/"+this.contestId+"/votes/items/"+e,jQuery.ajax({url:t,type:"POST",xhrFields:{withCredentials:!0}})},d.prototype.makeDeregisterVoteRequest=function(e){var t;if(!this.contestId)throw new Error("Contest ID not found");return t=Curalate.getProtocol()+"//"+Curalate.config.DOMAIN+"/"+Curalate.config.API_VERSION+"/contest/"+this.contestId+"/votes/items/"+e,jQuery.ajax({url:t,type:"DELETE",xhrFields:{withCredentials:!0}})},d.prototype.readVotesFromCache=function(e){var t;return I()?t=localStorage.getItem(e):m()&&(t=f(e)),t?JSON.parse(t):[]},d.prototype.cacheVotes=function(e,t){I()?localStorage.setItem(e,JSON.stringify(t)):m()&&(document.cookie=e+"="+JSON.stringify(t))},d.prototype.getVotesMap=function(){return this.readVotesFromCache("crl8.reels."+this.code).reduce(function(e,t){return e[t.itemId]=t,e},{})};var p=function(e,t,r){var o=new Date;o.setTime(o.getTime()+r);var a,n=o.toGMTString(),i=document.domain.split(".");a=-1!==["co","com"].indexOf(i[i.length-2])?"."+i.slice(-3).join("."):"."+i.slice(-2).join(".");var c=e+"="+t+";expires="+n+";domain="+a+";path=/";document.cookie=c},f=function(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var a=r[o];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""},m=function(){if(void 0!==e)return e;var e=navigator.cookieEnabled;return e||(document.cookie="testcookie",e=-1!==document.cookie.indexOf("testcookie")),e};d.prototype.getOrSetFirstPartyCuid=function(e){var t=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)})},r=f(e),o=r?r:t();return p(e,o,i),o},d.prototype.getFirstPartyExperiment=function(e){var t,r=f(a+e).split("-");return 2===r.length&&(t={eid:r[0],vid:r[1]}),t},d.prototype.setFirstPartyExperiment=function(e,t){t?p(a+e,t.eid+"-"+t.vid,c):p(a+e,"",-1*c)};var h,I=function(){if(void 0!==h)return h;if(!localStorage||"function"!=typeof localStorage.setItem)return!1;try{localStorage.setItem("crl8.test","foo"),h="foo"===localStorage.getItem("crl8.test"),localStorage.removeItem("crl8.test")}catch(e){h=!1}return h};d.callbacks={},Curalate.FanReel||(Curalate.FanReel=d)}();
var Curalate=window.Curalate||{};Curalate.FanReels=Curalate.FanReels||{},Curalate.Backbone=Backbone.noConflict(),Curalate._=_.noConflict(),Curalate.Backbone.deprecatedFunc=function(){window.console&&console.warn&&console.warn("Called into deprecated function.")},Curalate.FanReels.parseFilters=function(t){var e,a=Curalate._,i="TAGS",r={};return a.each(t,function(t,a){if(a.toUpperCase()===i&&"object"==typeof t)for(e=0;e<t.length;e++)null==r[t[e]]&&(r[t[e]]="");else a.toUpperCase()===i&&null==r[t]?r[t]="":null==r[t]&&(r[a]=t)}),r},Curalate.FanReels.mergeWithQueryArgs=function(t){var e=window.location.search.substring(1),a=e.split("&"),i=a.reduce(function(t,e){var a=e.split("="),i=decodeURIComponent(a[0]).toLowerCase(),r=i.match(/^curalate_(.*)/),o=i.match(/^crl8_(.*)/);return r&&r[1]?t[r[1]]=decodeURIComponent(a[1]).toLowerCase():o&&o[1]&&(t.crl8||(t.crl8={}),t.crl8[o[1]]=decodeURIComponent(a[1]).toLowerCase()),t},{}),r=Curalate._.omit(i,"filter","navigation","product_filters","productid");if(i.filters&&(r.filters={tags:i.filters}),i.product_filters){var o=i.product_filters.split(",");r.filters={},Curalate._.each(o,function(t){var e=t.split(":");r.filters[e[0]]=e[1]})}return i.navigation&&(r.navigation={infiniteScroll:"true"===i.navigation.toLowerCase()}),i.productid?r.productId=i.productid:Curalate._.isEmpty(i.productid)&&Curalate._.has(i,"productid")&&(r.productId=""),Curalate._.extend({},t,r)},function(t,e,a){t.$=Curalate.jQuery||jQuery;var i="large",r=1,o=window.attachEvent?!0:!1,s={ACTIVE:"Active",RESULTS:"Results"},c=t.Model.extend(),l=t.Collection.extend({model:c,limit:100,bookmark:null,filters:{},productId:null,metadata:null,locale:null,filterOperator:null,contestState:null,appId:"fanreel",initialize:function(t,a){if(!a)throw new Error("A FanReel identifier must be passed.");if(!a.code)throw new Error("A FanReel code must be present.");this.reel=new Curalate.FanReel({code:a.code,filters:a.filters}),e.extend(this,{limit:a.limit,bookmark:a.bookmark,productId:a.productId,metadata:a.metadata,fanreelId:a.code,useFA:!!a.useFA,displayType:a.displayType,firstLoad:!0,locale:a.locale,filterOperator:a.filterOperator,crl8:a.crl8}),this.productId&&(this.reel.productId=this.productId)},parse:function(t){return t.items},sync:function(t,a,i){var r=e.bind(i.complete,this),o=e.bind(i.success,this),s=e.bind(i.error,this);this.reel.retrieve({bookmark:this.bookmark,requestId:this.requestId,filters:e.isEmpty(this.filters)?null:this.filters,sortValue:this.sortValue,limit:this.limit,metadata:this.metadata,locale:this.locale,filterOperator:this.filterOperator,crl8:this.crl8,appId:this.appId}).success(e.bind(function(t){if(t.contest){var a=this.reel.getVotesMap();e.each(t.items,function(t){t.is_vote_active=!!a[t.id]})}r(i),o(t)},this)).failure(function(t){r(i),s(t)})},retrieve:function(i){i=i?e.clone(i):{};var r=i.success,o=i.complete,s=this;return i.complete=function(t){o&&o(t),s.trigger("fetch:complete")},i.success=function(t,e){e.contest&&e.contest.state&&e.contest.id&&(s.reel.contestId=e.contest.id,s.contestState=e.contest.state),s.trigger("retrieve"),r&&r(t,e,i),s.bookmark=e.bookmark,s.requestId=e.requestId,s.useFA&&s.firstLoad&&(window.fanreelAnalytics.init(e.items.length>0?{fanreelId:s.fanreelId,containerId:"#curalate-fan-reel",displayType:s.displayType,requestId:e.requestId,eVars:e.eVars,facebookAnalytics:e.facebookAnalytics,pdpProductId:s.reel.productId,gaNonInteractive:e.googleAnalyticsSettings.nonInteractiveEvents,jQuery:a}:{fanreelId:s.fanreelId,containerId:"#curalate-fan-reel",displayType:s.displayType,requestId:e.requestId,noContent:!0,pdpProductId:s.reel.productId,jQuery:a}),s.firstLoad=!1)},i.remove=!1,this.trigger("fetch:begin"),t.Collection.prototype.fetch.apply(this,[i])},fetch:function(t){return this.retrieve(t)},fetchMore:function(t){null!=this.bookmark?this.retrieve(t):t.complete&&setTimeout(t.complete,1)}}),n=t.View.extend({el:a("#curalate-fan-reel"),_super:t.View.prototype,hashPrefix:"crl8-",events:{},initialize:function(t){var e=this,i=a(document);i.on("click","#curalate-upload-photos",function(t){e._openPhotoPicker()}),t&&(this.collection.filters=Curalate.FanReels.parseFilters(t.filters),this.collection.metadata=t.metadata),this._initializeSortTracking(t),this._initializeFilterTracking(t),this.collection.once("retrieve",function(){this.contestState===s.ACTIVE?e.$el.addClass("curalate-contest-active"):this.contestState===s.RESULTS&&e.$el.addClass("curalate-contest-results")})},_initializeSortTracking:function(t){var e=this,i=t.navigation&&t.navigation.sortSelector?t.navigation.sortSelector:"[data-curalate-sort]",r=function(t){if(t){var i=a(t).attr("data-curalate-sort");i&&i!==e.collection.sort&&(e.collection.bookmark=null,e.collection.sortValue=i,e.collection.fetch({reset:!0,metadata:e.options.metadata}))}},o=a(i);switch(o.prop("tagName")){case"SELECT":o.change(function(){var t=a(this);t.attr("data-curalate-sort",t.find("option:selected").attr("data-curalate-sort-value")),r(this)});break;default:o.each(function(t,e){a(e).click(function(){r(e)})})}},_initializeFilterTracking:function(t){var i=this,r=t.navigation&&t.navigation.filter?t.navigation.filter:"[data-curalate-filter]",o=t.navigation&&t.navigation.filterValue?t.navigation.filterValue:"[data-curalate-filter-value]",s=t.navigation&&t.navigation.clearFilters?t.navigation.clearFilters:"[data-curalate-clear-filters]",c=t.navigation&&t.navigation.clearSortAndFilters?t.navigation.clearSortAndFilters:"[data-curalate-clear-sort-and-filters]",l=function(){i.collection.bookmark=null,i.collection.fetch({reset:!0,metadata:i.options.metadata})},n=function(t,e,a){a?delete i.collection.filters[t]:i.collection.filters[t]=e,l()},d=function(t){delete i.collection.filters[t]},u=function(t){d(t),l()};e.each(a(r),function(t){var i=a(t),r=i.attr("data-curalate-filter"),s=i.find(o),c={el:i,tagName:i.prop("tagName"),filterSelector:null};if(r&&s.length>0)switch(c.tagName){case"SELECT":i.change(function(){0===i.find("option:selected").attr("data-curalate-filter-value").trim().length?u(r):n(r,i.find("option:selected").attr("data-curalate-filter-value"),!1)});break;default:s.click(function(){var t,e=a(this);e.hasClass("curalate-active")||(t=0===e.attr("data-curalate-filter-value").trim().length,n(r,e.attr("data-curalate-filter-value"),t),i.find(".curalate-active").removeClass("curalate-active"),e.addClass("curalate-active"))})}else if(!r&&s.length>0)switch(c.tagName){case"SELECT":i.change(function(){e.each(s,function(t){d(a(t).attr("data-curalate-filter-value"))}),0===i.find("option:selected").attr("data-curalate-filter-value").trim().length?l():n(i.find("option:selected").attr("data-curalate-filter-value"),null,!1)});break;default:s.click(function(){var t=a(this);t.hasClass("curalate-active")||(e.each(s,function(t){d(a(t).attr("data-curalate-filter-value"))}),0===t.attr("data-curalate-filter-value").trim().length?l():n(t.attr("data-curalate-filter-value"),null,i.hasClass(".curalate-active")),i.find(".curalate-active").removeClass("curalate-active"),t.addClass("curalate-active"))})}else r?i.click(function(){var t=a(this);n(r,t.attr("data-curalate-filter-value"),t.hasClass(".curalate-active")),t.toggleClass("curalate-active")}):r||i.click(function(){n(r,null,i.hasClass(".curalate-active")),a(this).toggleClass("curalate-active")})}),a(s).click(function(){a(".curalate-active").removeClass("curalate-active"),a(this).toggleClass("curalate-active"),i.collection.filters={},l()}),a(c).click(function(){i.collection.filters={},i.collection.sortValue=null,l()})},_openPhotoPicker:function(){this.collection.reel.showPhotoPicker(this.options)}}),d=t.View.extend({className:"product",templateName:"product-template",_super:t.View.prototype,hashprefix:"crl8-",initialize:function(t,e){this.product=t,this.itemId=e,this.prodPos=r,r+=1},render:function(){return this.$el.html(this.template(this.product.model)),this},template:function(t){var t=t||this.product.model,i=a("[data-"+this.templateName+"]").first().clone().removeClass("curalate-hidden").removeAttr("data-"+this.templateName),r=i.find("[data-curalate-product-id]"),o=i.find("[data-curalate-product-style-id]"),s=i.find("[data-curalate-product-name]"),c=i.find("[data-curalate-product-url]"),l=i.find("[data-curalate-product-description]"),n=i.find("[data-curalate-product-image]"),d=i.find("[data-curalate-product-price]"),u=i.find("[data-curalate-product-metadata]"),h=i.find("[data-curalate-uploader-metadata]"),p=i.find("img[data-curalate-accessible]");return a.isEmptyObject(t)?i:(i.attr("data-curalate-product-container",""),i.attr("data-curalate-item-id",this.itemId),i.attr("data-curalate-product-id",t.id),i.attr("data-curalate-product-style-id",t.styleId),i.attr("data-curalate-product-position",this.prodPos),t.isAvailable||i.addClass("curalate-product-not-available"),e.each(r,function(e,i){a(e).text(t?t.id:"")},this),e.each(o,function(e,i){a(e).text(t?t.styleId:"")},this),e.each(s,function(e,i){a(e).text(t?t.name:"")},this),e.each(c,function(e,i){var r=a(e);switch(e.nodeName.toUpperCase()){case"A":t?(r.attr("href",t.link),r.attr("data-tracking-click-deferred","product-"+this.itemId),r.attr("data-tracking-product-id","product-"+t.id),r.attr("data-curalate-product-click",""),r.attr("data-curalate-item-id",this.itemId),r.attr("data-curalate-product-id",t.id),r.attr("data-curalate-product-style-id",t.styleId)):r.attr("href","javascript:void(0);")}},this),e.each(l,function(e,i){a(e).text(t?t.description||"":"")},this),e.each(u,function(e,i){var r,o,s,c=a(e);if(r=t?t.metadata:null,o=c.attr("data-curalate-product-metadata"),r&&o)switch(s=r[o],e.nodeName.toUpperCase()){case"A":c.attr("href",s||"javascript:void(0)"),c.attr("data-tracking-click-deferred","product-"+this.itemId);break;default:c.text(s||"")}},this),e.each(n,function(e,i){var r=a(e);if(t&&t.image)switch(e.nodeName.toUpperCase()){case"IMG":r.attr("src",t.image),r.attr("alt",t.name||"");break;case"DIV":r.css("background-image","url("+t.image+")")}},this),e.each(d,function(e,i){a(e).text(t?t.price:"")},this),e.each(h,function(t,e){var i=a(t),r=attributes.user?attributes.user.metadata:null,o=i.attr("data-curalate-uploader-metadata");r&&o&&i.text(r[o])},this),e.each(p,function(t,e){attributes.altText&&a(t).attr("alt",attributes.altText)},this),i)}}),u=t.View.extend({className:"item",templateName:"item-template",_super:t.View.prototype,hashPrefix:"crl8-",animate:!0,isAnimationEnabled:function(){return this.animate&&!o},events:{"mouseover [data-curalate-image]":"showImageOverlay",mouseleave:"hideImageOverlay","click [data-curalate-video-ctrl]":"playPauseVideo",'mouseleave [data-curalate-video-onleave="stop"]':"stopVideo",'mouseleave [data-curalate-video-onleave="pause"]':"pauseVideo","click [data-curalate-vote]":"toggleVote"},initialize:function(t){t.templateName&&(this.templateName=t.templateName)},formatElapsedTime:function(t){var e=Math.floor((new Date).valueOf()/1e3),a=e-t,i=60,r=60*i,o=24*r,s=7*o,c=52*s;return i>a?"Less than a minute ago":2*i>a?"1 minute ago":r>a?parseInt(a/i,10)+" minutes ago":2*r>a?"1 hour ago":o>a?parseInt(a/r,10)+" hours ago":2*o>a?"1 day ago":s>a?parseInt(a/o,10)+" days ago":2*s>a?"1 week ago":c>a?parseInt(a/s,10)+" weeks ago":2*c>a?"1 year ago":parseInt(a/c,10)+" years ago"},render:function(){return this.$el.html(this.template(this.model.attributes)),this},template:function(t){var t=t||this.model.attributes,i=a("[data-"+this.templateName+"]").first().clone().removeClass("curalate-hidden"),r=i.find("[data-curalate-image]"),o=i.find("[data-curalate-video]"),s=i.find("[data-curalate-video-ctrl]"),c=i.find("[data-curalate-avatar]"),l=i.find("[data-curalate-user-full-name-or-username]"),n=i.find("[data-curalate-user-full-name]"),d=i.find("[data-curalate-username]"),u=i.find("[data-curalate-caption]"),h=i.find("[data-curalate-comments]"),p=i.find("[data-curalate-likes]"),f=i.find("[data-curalate-vote-container]"),m=i.find("[data-curalate-votes]"),v=i.find("[data-curalate-repins]"),g=i.find("[data-curalate-item-url]"),w=i.find("[data-curalate-product-id]"),C=i.find("[data-curalate-product-style-id]"),y=i.find("[data-curalate-product-name]"),k=i.find("[data-curalate-product-metadata]"),I=i.find("[data-curalate-product-url]"),V=i.find("[data-curalate-product-description]"),b=i.find("[data-curalate-product-image]"),x=i.find("[data-curalate-product-price]"),_=i.find("[data-curalate-products]"),P=i.find("[data-curalate-posted-elapsed]"),R=i.find("[data-curalate-facebook-share]"),F=i.find("[data-curalate-twitter-share]"),O=i.find("[data-curalate-pinterest-share]"),E=i.find("[data-curalate-uploader-metadata]"),A=i.find("img[data-curalate-accessible]");return a.isEmptyObject(t)?i:(this.$products=_,t.product=t.products[0],e.each(r,function(i,r){var o,s=a(i),c=s.attr("data-curalate-image"),l=t.photo[c],n=function(){a("#"+o).css("visibility","visible").fadeTo("fast",1).removeAttr("id")};switch(this.resize&&s.css({height:l.height}),this.isAnimationEnabled()&&(o=e.uniqueId("crl8-"),s.css({visibility:"hidden",opacity:0}),s.attr("id",o)),i.nodeName.toUpperCase()){case"IMG":s.attr("src",l.url),s.attr("alt",t.caption||"");break;case"DIV":s.css("background-image","url("+l.url+")")}if(this.isAnimationEnabled())if("IMG"===i.nodeName.toUpperCase())s.load(function(){n()}).each(function(){this.complete&&a(this).load()});else{var d=new Image;d.onload=function(){n()},d.src=l.url}},this),e.each(o,function(e,i){var r,o=a(e),s=o.siblings("[data-curalate-image]").first().attr("data-curalate-image"),c=t.photo[s],l=o.attr("data-curalate-video"),n=t.video?t.video[l]:null;n&&"VIDEO"===e.nodeName&&(r=a("<source />").attr({src:n.url,type:"video/mp4",preload:"metadata"}).css({"max-width":c.width,"max-height":c.height}),o.append(r))},this),e.each(s,function(e,i){t.video||a(e).hide()},this),e.each(c,function(i,r){var o,s=a(i),c=s.data("curalate-avatar"),l=t.user[c],n=function(){a("#"+o).css("visibility","visible").fadeTo("fast",1).removeAttr("id")};if(l){switch(this.isAnimationEnabled()&&(o=e.uniqueId("crl8-"),s.css({visibility:"hidden",opacity:0}).attr("id",o)),i.nodeName.toUpperCase()){case"IMG":s.attr("src",l.url),s.attr("alt",t.user.display_name||"");break;case"DIV":s.css("background-image",l.url)}if(this.isAnimationEnabled())if("IMG"===i.nodeName.toUpperCase())s.load(function(){n()}).each(function(){this.complete&&a(this).load()});else{var d=new Image;d.onload=function(){n()},d.src=l.url}}else s.remove()},this),e.each(n,function(e,i){a(e).text(t.user.display_name||"")},this),e.each(l,function(e,i){var r=a(e),o=r.attr("data-curalate-user-full-name-or-username");switch(o){case"full-name":r.text(t.user.display_name||t.user.username||"");break;case"username":r.text(t.user.username||t.user.display_name||"");break;default:r.text(t.user.display_name||t.user.username||"")}},this),e.each(d,function(e,i){a(e).text(t.user.username||"")},this),e.each(u,function(e,i){a(e).text(t.caption||"")},this),e.each(h,function(e,i){a(e).text(t.comment_count||0)},this),e.each(p,function(e,i){a(e).text(t.like_count||0)},this),e.each(f,function(e,i){a(e).toggleClass("curalate-vote-active",!!t.is_vote_active)},this),e.each(m,function(e,i){a(e).text(t.vote_count||0)},this),e.each(v,function(e,i){a(e).text(t.repin_count||0)},this),e.each(g,function(e,i){switch(e.nodeName.toUpperCase()){case"A":a(e).attr("href",t.url)}},this),e.each(w,function(e,i){a(e).text(t.product?t.product.id:"")},this),e.each(C,function(e,i){a(e).text(t.product?t.product.styleId:"")},this),e.each(y,function(e,i){a(e).text(t.product?t.product.name:"")},this),e.each(k,function(e,i){var r,o,s,c=a(e);if(r=t.product?t.product.metadata:null,o=c.attr("data-curalate-product-metadata"),r&&o)switch(s=r[o],e.nodeName.toUpperCase()){case"A":c.attr("href",s||"javascript:void(0)"),c.attr("data-tracking-click-deferred","product-"+t.id);break;default:c.text(s||"")}},this),e.each(I,function(e,i){var r=a(e);switch(e.nodeName.toUpperCase()){case"A":t.product?(r.attr("href",t.product.link),r.attr("data-tracking-click-deferred","product-"+t.id),r.attr("data-tracking-product-id","product-"+t.product.id),r.attr("data-curalate-product-click",""),r.attr("data-curalate-item-id",t.id),r.attr("data-curalate-product-id",t.product.id),r.attr("data-curalate-product-style-id",t.product.styleId)):r.attr("href","javascript:void(0);")}},this),e.each(R,function(e,i){a(e).attr("data-tracking-click","facebook-share-click-item-"+t.id)},this),e.each(F,function(e,i){a(e).attr("data-tracking-click","twitter-share-click-item-"+t.id)},this),e.each(O,function(e,i){a(e).attr("data-tracking-click","pinterest-share-click-item-"+t.id)},this),e.each(_,function(e,a){this.addProducts(t.products,t.id)},this),e.each(V,function(e,i){a(e).text(t.product?t.product.description||"":"")},this),e.each(b,function(e,i){var r=a(e);if(t.product&&t.product.image){switch(e.nodeName.toUpperCase()){case"IMG":r.attr("src",t.product.image),r.attr("alt",t.product.name);break;case"DIV":r.css("background-image","url("+t.product.image+")")}r.attr("data-curalate-product-container",""),r.attr("data-curalate-item-id",t.id),r.attr("data-curalate-product-id",t.product.id),r.attr("data-curalate-product-style-id",t.product.styleId),r.attr("data-curalate-product-position",this.prodPos)}},this),e.each(x,function(e,i){a(e).text(t.product?t.product.price:"")},this),e.each(P,function(e,i){a(e).text(t.timestamp?this.formatElapsedTime(t.timestamp):"")},this),e.each(E,function(e,i){var r=a(e),o=t.user?t.user.metadata:null,s=r.attr("data-curalate-uploader-metadata");o&&s&&r.text(o[s])},this),e.each(A,function(e,i){t.altText&&a(e).attr("alt",t.altText)},this),i)},addProduct:function(t,e){var a=new Curalate.FanReels.ProductView({model:t,id:"product-"+t.id},e);this.$products.append(a.render().el)},addProducts:function(t,a){r=1,e.each(t,function(t){this.addProduct(t,a)},this)},showImageOverlay:function(){this.$("[data-curalate-image-overlay]").stop(!0,!0).fadeTo("fast",.3)},hideImageOverlay:function(){this.$("[data-curalate-image-overlay]").stop(!1,!0).fadeOut(100)},playPauseVideo:function(t){var e=this,i=e.$el,r=e.activeVideo,o=a(t.target).attr("data-curalate-video-ctrl"),s=o.indexOf("play")>-1,c=o.indexOf("pause")>-1,l=i.find("[data-curalate-video]").first(),n=l?l.get(0):null,d=l.siblings("[data-curalate-image]").first(),u=!0;t.preventDefault(),t.stopPropagation(),s?(r&&(r.video===n?(r.video.play(),i.removeClass("curalate-video-paused"),u=!1):e.stopVideo()),u&&(e.activeVideo={$videoElmt:l,video:n,$imageElmt:d}),d.hide(),l.show(),i.addClass("curalate-video-active").removeClass("curalate-video-paused"),n.play(),n.addEventListener("ended",function(){e.stopVideo()})):c&&r&&r.video===n&&e.pauseVideo()},pauseVideo:function(){var t=this.$el,e=this.activeVideo;e&&(e.video.pause(),t.addClass("curalate-video-paused"))},stopVideo:function(){var t=this,e=this.$el,a=this.activeVideo;a&&(a.video.pause(),a.video.load(),a.$videoElmt.hide(),a.$imageElmt.show(),e.removeClass("curalate-video-active curalate-video-paused"),t.activeVideo=null)},getVotingCacheKey:function(){return"crl8.reels."+Curalate.FanReels.PhotosCollection.reel.code},isContestActive:function(){return Curalate.FanReels.PhotosCollection.contestState===s.ACTIVE},toggleVote:function(){if(this.isContestActive()){var t=Curalate.FanReels.PhotosCollection.reel.readVotesFromCache(this.getVotingCacheKey()),a=e.reject(t,e.bind(function(e){return this.isVoteExpired(e,t)},this));Curalate.FanReels.PhotosCollection.reel.cacheVotes(this.getVotingCacheKey(),a),t=a;var i=e.extend(this.getVotingMetadata(),{itemId:this.model.id,timestamp:Date.now()}),r=!e.findWhere(t,{itemId:this.model.id});r?this.validateVote(i,t).done(e.bind(this.registerVote,this,i)).fail(e.bind(function(e){this.onInvalidVote(e,i,t)},this)):this.deregisterVote(i)}},registerVote:function(t){if(this.isContestActive()&&!this.isVoteRequestOutstanding){var a=this,i=Curalate.FanReels.PhotosCollection.reel.readVotesFromCache(this.getVotingCacheKey());return this.isVoteRequestOutstanding=!0,Curalate.FanReels.PhotosCollection.reel.makeRegisterVoteRequest(t.itemId).always(e.bind(function(){this.isVoteRequestOutstanding=!1},this)).then(e.bind(function(){i.push(t),Curalate.FanReels.PhotosCollection.reel.cacheVotes(this.getVotingCacheKey(),i),a.onVoteRegistered(t.itemId)},this))}},deregisterVote:function(t){if(this.isContestActive()&&!this.isVoteRequestOutstanding){var a=this,i=Curalate.FanReels.PhotosCollection.reel.readVotesFromCache(this.getVotingCacheKey());return this.isVoteRequestOutstanding=!0,Curalate.FanReels.PhotosCollection.reel.makeDeregisterVoteRequest(t.itemId).always(e.bind(function(){this.isVoteRequestOutstanding=!1},this)).then(e.bind(function(){i=e.without(i,e.findWhere(i,{itemId:t.itemId})),Curalate.FanReels.PhotosCollection.reel.cacheVotes(this.getVotingCacheKey(),i),a.onVoteDeregistered(t.itemId)},this))}},onVoteRegistered:function(t){var a=e.findWhere(Curalate.FanReels.PhotosCollection.models,{id:t});a.set("vote_count",(a.get("vote_count")||0)+1),a.set("is_vote_active",!0)},onVoteDeregistered:function(t){var a=e.findWhere(Curalate.FanReels.PhotosCollection.models,{id:t});a.set("vote_count",Math.max(0,(a.get("vote_count")||0)-1)),a.set("is_vote_active",!1)},isVoteExpired:function(t,e){return this.isContestActive()?t.timestamp<Date.now()-7776e6:!1},getVotingMetadata:function(){return{}},validateVote:function(t,e){return a.Deferred().resolve().promise()},onInvalidVote:function(t,e,a){}}),h=u.extend({templateName:"photo-modal-template",_super:u.prototype,hashPrefix:"crl8-",forceRedirectToGallery:-1===document.referrer.indexOf(this.hashPrefix),events:e.extend(u.prototype.events,{"click [data-curalate-modal-next-page]":"nextPhoto","click [data-curalate-modal-previous-page]":"previousPhoto","click .curalate-modal-close":"closeModal","click .curalate-facebook-icon":"shareOnFacebook","click .curalate-twitter-icon":"shareOnTwitter","click .curalate-pinterest-icon":"shareOnPinterest","keydown .curalate-photo-detail-container":"keyHandler"}),animate:!0,initialize:function(t){if(this._super.initialize.apply(this,arguments),!t.code)throw new Error("You must provide a FanReel code for a modal view.");this.reel=new Curalate.FanReel({code:t.code}),a(window).on("hashchange",e.bind(function(t){window.location.hash.length&&window.location.hash.substring(1)!==this.hashPrefix+"gallery"||this.closeModal(t,!0)},this)),a(".curalate-overlay").on("click",e.bind(function(t){a(t.target).hasClass("curalate-overlay")&&this.closeModal(t,!1)},this)),t.productId&&(this.productId=t.productId),t.filters&&(this.filters=t.filters),t.metadata&&(this.metadata=t.metadata),t.locale&&(this.locale=t.locale),t.filterOperator&&(this.filterOperator=t.filterOperator),t.crl8&&(this.crl8=t.crl8)},_success:function(t){this.model=new c(t.item),this.next=t.next,this.previous=t.prev,this.model.set("is_vote_active",!!this.reel.getVotesMap()[this.model.get("id")]),t.item&&this.render().show()},_failure:function(t){throw new Error(t)},load:function(t,e,a,i,r,o){var s=this;this.sortValue=e,this.filters=a,this.metadata=i,this.locale=r,this.filterOperator=o,this.reel.retrieveItemById({id:t,productId:this.productId,sortValue:this.sortValue,filters:this.filters,metadata:this.metadata,locale:this.locale,filterOperator:this.filterOperator,crl8:this.crl8,appId:this.appId}).success(function(t){s._success.call(s,t)}).failure(function(t){s._failure.call(s,t)})},show:function(){this.$el.show().addClass("active").children().addClass("active")},render:function(){return this.$el.html(this.template(this.model.attributes)),this},template:function(t){var e=this,r=this._super.template.apply(this,arguments),o=(new Curalate.Spinner).spin(),s=r.find("[data-curalate-image]"),c=(r.find("[data-curalate-video]"),window.location.href.replace(window.location.hash,""));return a.isEmptyObject(t)?r.html():(s.css("height",t.photo[s.data("curalate-image")||i].height),this.$el.hasClass("active")&&r.addClass("active").children().addClass("active"),""==window.location.hash&&window.history.replaceState&&window.history.replaceState({id:"gallery"},null,c+"#"+this.hashPrefix+"gallery"),window.history.replaceState&&(-1!=window.location.hash.indexOf(this.hashPrefix+"gallery")?window.history.pushState({id:t.id},null,c+"#"+this.hashPrefix+t.id):window.history.replaceState({id:t.id},null,c+"#"+this.hashPrefix+t.id)),r.find("[data-curalate-spinner]").append(o.spin().el),this.next?r.find("[data-curalate-modal-next-page]").show().attr({"data-tracking-click":"item-"+this.next,"data-curalate-item-click":"","data-curalate-item-id":this.next}):r.find("[data-curalate-modal-next-page]").hide(),this.previous?r.find("[data-curalate-modal-previous-page]").show().attr({"data-tracking-click":"item-"+this.previous,"data-curalate-item-click":"","data-curalate-item-id":this.previous}):r.find("[data-curalate-modal-previous-page]").hide(),s.load(function(){e.$el.find("[data-curalate-spinner]").empty(),o.stop()}).each(function(){this.complete&&a(this).load()}),r.html())},keyHandler:e.throttle(function(t){39===t.which?this.nextPhoto(t):37===t.which?this.previousPhoto(t):27===t.which&&this.closeModal(t,!1,!0)},100),nextPhoto:function(t){t.preventDefault(),this.next&&(this._super.stopVideo.apply(this,arguments),this.load(this.next,this.sortValue,this.filters,this.metadata,this.locale,this.filterOperator))},previousPhoto:function(t){t.preventDefault(),this.previous&&(this._super.stopVideo.apply(this,arguments),this.load(this.previous,this.sortValue,this.filters,this.metadata,this.locale,this.filterOperator))},_openShareWindow:function(t,e){t+="?"+a.param(e),window.open(t,"_blank","width=450,height=300")},shareOnFacebook:function(){var t="https://www.facebook.com/sharer/sharer.php",e={s:100,"p[title]":this.$el.find("[data-curalate-caption]").text(),"p[images][0]":"https:"+this.$el.find("[data-curalate-image]").attr("src"),"p[summary]":"","p[url]":window.location.href};this._openShareWindow(t,e)},shareOnTwitter:function(){var t="https://twitter.com/share",e={source:"webclient",text:this.$el.find("[data-curalate-caption]").text()+" https:"+this.$el.find("[data-curalate-image]").attr("src")};this._openShareWindow(t,e)},shareOnPinterest:function(){var t="http://pinterest.com/pin/create/button/",e={media:"https:"+this.$el.find("[data-curalate-image]").attr("src"),description:caption=this.$el.find("[data-curalate-caption]").text(),ref:window.location.href,url:window.location.href};this._openShareWindow(t,e)},closeModal:function(t,e,i){this._super.stopVideo.apply(this,arguments),(a(t.target)[0]===a(t.currentTarget)[0]||i)&&(a(".curalate-photo-detail-container").removeClass("active"),setTimeout(function(){a(".curalate-overlay").removeClass("active").hide()},500)),!e&&window.history.replaceState&&(this.forceRedirectToGallery?(this.forceRedirectToGallery=!1,window.history.replaceState({id:"gallery"},null,window.location.href.replace(window.location.hash,"")+"#"+this.hashPrefix+"gallery")):window.history.back())},onVoteRegistered:function(t){var a=e.findWhere(Curalate.FanReels.PhotosCollection.models,{id:t}),i=(a.get("vote_count")||0)+1;this.model.set("vote_count",i),a.set("vote_count",i),this.model.set("is_vote_active",!0),a.set("is_vote_active",!0)},onVoteDeregistered:function(t){var a=e.findWhere(Curalate.FanReels.PhotosCollection.models,{id:t}),i=Math.max(0,(a.get("vote_count")||0)-1);this.model.set("vote_count",i),a.set("vote_count",i),this.model.set("is_vote_active",!1),a.set("is_vote_active",!1)}});e.extend(Curalate.FanReels,{Photo:c,Photos:l,BaseView:n,DetailModal:h,BaseItemView:u,ProductView:d})}(Curalate.Backbone,Curalate._,Curalate.jQuery||jQuery);
var Curalate=window.Curalate||{};Curalate.FanReels=Curalate.FanReels||{},Curalate.FanReels.Gallery=Curalate.FanReels.Gallery||{},function(e,a,t){var l,i=window.location.hash,o=(new Curalate.Spinner).spin(),r=1,n=Curalate.FanReels.BaseItemView.extend({className:"curalate-thumbnail",templateName:"curalate-photo-template",_super:Curalate.FanReels.BaseItemView.prototype,events:a.extend(Curalate.FanReels.BaseItemView.prototype.events,{"click [data-curalate-image-overlay]":"showPhotoDetail","click [data-curalate-image]":"showPhotoDetail",keydown:"keyPress"}),initialize:function(e){this._super.initialize.apply(this,arguments),this.hasModal=e.hasModal,this.itemPos=r,r+=1,this.$el.attr({"data-tracking-hover":"item-"+this.model.get("id"),"data-tracking-click":"item-"+this.model.get("id"),"data-curalate-item-container":"","data-curalate-item-click":"","data-curalate-item-id":this.model.get("id"),"data-curalate-item-position":this.itemPos,"data-curalate-item-detail":this.hasModal?1:0}),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},keyPress:a.throttle(function(e){13===e.which&&this.showPhotoDetail()},100),template:function(e){return t(this._super.template.apply(this,arguments)).html()},showPhotoDetail:function(){this.hasModal&&l.load(this.model.get("id"),this.model.collection.sortValue,this.model.collection.filters,this.model.collection.metadata,this.model.collection.locale,this.model.collection.filterOperator)}}),s=Curalate.FanReels.BaseView.extend({scrollPadding:0,initialize:function(e){var l=this,i=t(window),o=!1;Curalate.FanReels.BaseView.prototype.initialize.apply(this,arguments),a.extend(this,{hasModal:e.hasModal,navigation:{loadMore:e.navigation&&e.navigation.loadMore?e.navigation.loadMore:l.$("[data-curalate-load-more]"),infiniteScroll:e.navigation&&null!=e.navigation.infiniteScroll?e.navigation.infiniteScroll:!0}}),this.$pictures=this.$(".curalate-thumbs"),this.listenTo(this.collection,"add",this.addPhoto),this.listenTo(this.collection,"reset",this.addPhotos),this.$el.attr("data-tracking-hover",""),this.navigation.loadMore&&this.navigation.loadMore.click(function(){o||(o=!0,l.loadMore().once("fetch:complete",function(){o=!1}))}),this.navigation.infiniteScroll&&i.on("scroll",function(){var e=i.scrollTop()+i.height(),a=l.$el.position().top+l.$el.outerHeight();e+l.scrollPadding>=a&&!o&&(o=!0,l.loadMore().once("fetch:complete",function(){o=!1}))}),this.collection.fetch(e)},addPhoto:function(e){var a=new Curalate.FanReels.Thumbnail({model:e,id:"photo-"+e.id,hasModal:this.hasModal,metadata:this.options.metadata});this.$pictures.append(a.render().el)},addPhotos:function(e){this.$pictures.empty(),r=1,e.each(this.addPhoto,this)},loadMore:function(){var e=this;return a.isUndefined(this.collection.bookmark)||this.$(".curalate-lazy-load-spinner").append(o.spin().el),this.collection.fetchMore({complete:function(){o.stop(),e.trigger("fetch:complete")},metadata:e.options.metadata,locale:e.options.locale,filterOperator:e.options.filterOperator}),this}});a.extend(Curalate.FanReels,{Thumbnail:n,Gallery:s}),Curalate.FanReels.Gallery.defaultOptions={pageSize:3,hasModal:!0},Curalate.FanReels.Gallery.load=function(o){var r,n,s=Curalate.FanReels.DetailModal.prototype.hashPrefix;return o=Curalate.FanReels.mergeWithQueryArgs(a.defaults(o,this.defaultOptions)),r=4*o.pageSize,Curalate.FanReels.PhotosCollection=new Curalate.FanReels.Photos([],{code:o.code,productId:o.productId,filters:o.filters,useFA:o.useFA,displayType:o.displayType,limit:r,locale:o.locale,filterOperator:o.filterOperator,crl8:o.crl8}),l=new Curalate.FanReels.DetailModal({el:t(".curalate-overlay"),code:o.code,productId:o.productId,metadata:o.metadata,locale:o.locale,filterOperator:o.filterOperator,crl8:o.crl8}),o.useFA?Curalate.tracking={recordImpression:e.deprecatedFunc,initializeClickTracker:e.deprecatedFunc,initializeDwellTracker:e.deprecatedFunc,initializeVisibilityTracker:e.deprecatedFunc}:(Curalate.tracking.recordImpression("fr."+o.code),Curalate.tracking.initializeClickTracker("fr."+o.code),Curalate.tracking.initializeDwellTracker("fr."+o.code),Curalate.tracking.initializeVisibilityTracker("curalate-fan-reel","fr."+o.code)),i.length&&1===i.indexOf(s)&&-1===i.indexOf("gallery")&&(n=i.substr(s.length+1),l.load(n,null,Curalate.FanReels.parseFilters(o.filters),o.metadata,o.locale,o.filterOperator)),new Curalate.FanReels.Gallery({collection:Curalate.FanReels.PhotosCollection,hasModal:o.hasModal,pageSize:o.pageSize,navigation:o.navigation,filters:o.filters,metadata:o.metadata,locale:o.locale,filterOperator:o.filterOperator,restoreQueryParams:o.restoreQueryParams,productId:o.productId,crl8:o.crl8})}}(Curalate.Backbone,Curalate._,Curalate.jQuery||jQuery);

	})(Curalate);
} catch(err) {
	if (Curalate.sendErrorRequest) {
		Curalate.sendErrorRequest(err, 'fanreelexception');
	}
	throw err;
}